import{aq as R,ar as U,r as u,w as S,o as k,c as z,b as a,e,s as r,f as I,as as y,a3 as b,a2 as T,x as j,D as F,F as M,m as N,t as L,V as $}from"./index-DvA8P6Gk.js";import{a as A,u as E,g as O,d as X}from"./regionService-DqS0EUTU.js";import{V as D,b as w,d as G}from"./VCard-DAsvdsxx.js";import{V as C}from"./VDivider-zS_1rsPv.js";import{V as _,a as v}from"./VRow-CXlrfULG.js";import{V as H}from"./VForm-D9gYKK0p.js";import{V as h}from"./VDialog-iIM7ayQQ.js";import{V as J}from"./VDataTableVirtual-DKZT2oRp.js";import"./axios-B6xj8bPG.js";import"./VAvatar-B_KDJW1g.js";import"./VImg-C2yDnbiZ.js";import"./filter-B20m9EDS.js";import"./VList-_OenMqFZ.js";import"./VChip-BB7pSCHc.js";const K=R("region",{state:()=>({headers:[{title:"№",align:"start",key:"id",sortable:!1},{title:"Viloyat nomi",align:"start",key:"name_uz"},{title:"Sozlamalar",align:"end",key:"actions",sortable:!1}]}),actions:{}}),P={class:"text-center"},Q={__name:"UpdateRegion",props:{updatingItem:Object,updateDialog:{type:Boolean,default:!1}},emits:["updated","update:updateDialog"],setup(q,{emit:x}){const m=q,f=x;function c(){f("update:updateDialog",!1)}const p=U(),i=u(null),n=u(null);async function g(){const d=await A(m.updatingItem.id);d&&(i.value=d)}async function V(){const{valid:d}=await n.value.validate();if(!d)return;const o=await E(m.updatingItem.id,i.value);(o==null?void 0:o.status)===200?(p.success("Muvofaqqiyatli yaratildi."),f("update:updateDialog",!1),f("updated"),n.value.reset()):p.error("Xatolik yuz berdi")}return S(()=>m.updateDialog,d=>{g()}),(d,o)=>(k(),z("div",P,[a(h,{modelValue:m.updateDialog,"onUpdate:modelValue":o[2]||(o[2]=t=>m.updateDialog=t),"max-width":"800"},{default:e(()=>[a(D,{class:"pa-4"},{default:e(()=>[a(w,null,{default:e(()=>o[3]||(o[3]=[r(" Viloyat ma'lumotlarini tahrirlash ")])),_:1}),a(C,{class:"mb-4"}),i.value?(k(),I(H,{key:0,ref_key:"form",ref:n,onSubmit:T(V,["prevent"])},{default:e(()=>[a(_,null,{default:e(()=>[a(v,{cols:"12",md:"6"},{default:e(()=>[a(y,{modelValue:i.value.name_uz,"onUpdate:modelValue":o[0]||(o[0]=t=>i.value.name_uz=t),rules:[t=>!!t||"to'ldirish majburiy!",t=>t&&t.length>=3||"Viloyat nomi kamida 3 harfdan iborat bo'lishi zarur"],label:"Viloyat nomi (uz)",required:""},null,8,["modelValue","rules"])]),_:1}),a(v,{cols:"12",md:"6"},{default:e(()=>[a(y,{modelValue:i.value.name_ru,"onUpdate:modelValue":o[1]||(o[1]=t=>i.value.name_ru=t),rules:[t=>!!t||"to'ldirish majburiy!",t=>t&&t.length>=3||"Viloyat nomi kamida 3 harfdan iborat bo'lishi zarur"],label:"Название региона (ru)",required:""},null,8,["modelValue","rules"])]),_:1})]),_:1}),a(G,{class:"d-flex w-full justify-end mt-4"},{default:e(()=>[a(b,{color:"error",variant:"elevated",onClick:c},{default:e(()=>o[4]||(o[4]=[r(" bekor qilish ")])),_:1}),a(b,{color:"success",type:"submit",variant:"elevated"},{default:e(()=>o[5]||(o[5]=[r(" saqlash ")])),_:1})]),_:1})]),_:1},512)):j("",!0)]),_:1})]),_:1},8,["modelValue"])]))}},ma={__name:"index",setup(q){const x=U(),m=K(),f=u(!1),c=u([]),p=u(null);async function i(){f.value=!0;const t=await O();f.value=!1,t&&(c.value=t)}const n=u(!1),g=u(null),V=u(!1);async function d(){V.value=!0;const t=await X(g.value.id);V.value=!1,t.status===200&&x.success("Muvofaqqiyatli o'chirildi"),n.value=!1,await i()}const o=u(!1);return F(()=>{i()}),(t,l)=>(k(),z(M,null,[a(Q,{"update-dialog":o.value,"onUpdate:updateDialog":l[0]||(l[0]=s=>o.value=s),"updating-item":g.value,onUpdated:i},null,8,["update-dialog","updating-item"]),a(D,{flat:""},{default:e(()=>[a(_,{class:"ma-2"},{default:e(()=>[a(v,{cols:"12",md:"6"},{default:e(()=>[a(w,{class:"d-flex align-center pe-2"},{default:e(()=>l[6]||(l[6]=[r(" Viloyatlar ro'yxati ")])),_:1})]),_:1}),a(v,{class:"d-flex",cols:"12",md:"6"},{default:e(()=>[a(y,{modelValue:p.value,"onUpdate:modelValue":l[1]||(l[1]=s=>p.value=s),density:"compact","hide-details":"",label:"qidirish...","prepend-inner-icon":"mdi-magnify"},null,8,["modelValue"])]),_:1})]),_:1}),a(C),a(J,{search:p.value,"onUpdate:search":l[2]||(l[2]=s=>p.value=s),"filter-keys":["name_uz","name_ru"],headers:N(m).headers,items:c.value,loading:f.value,"fixed-header":"",height:"71vh","loading-text":"ma'lumotlar yuklanmoqda","no-data-text":"ma'lumot topilmadi"},{"item.id":e(({item:s,index:B})=>[r(L(B+1),1)]),_:1},8,["search","headers","items","loading"]),a(h,{modelValue:n.value,"onUpdate:modelValue":l[5]||(l[5]=s=>n.value=s),"max-width":"800",persistent:""},{default:e(()=>[a(D,{class:"pa-4"},{actions:e(()=>[a($),a(b,{color:"success",onClick:l[4]||(l[4]=s=>n.value=!1)},{default:e(()=>l[8]||(l[8]=[r(" Bekor qilish ")])),_:1}),a(b,{loading:V.value,color:"error",onClick:d},{default:e(()=>l[9]||(l[9]=[r(" Tasdiqlash ")])),_:1},8,["loading"])]),default:e(()=>[a(w,{class:"text-center mb-4 font-weight-bold"},{default:e(()=>l[7]||(l[7]=[r(" Ushbu ma'lumotni o'chirishni tasdiqlaysizmi? ")])),_:1}),a(_,{class:"mb-4"},{default:e(()=>[a(v,{cols:"12",md:"12"},{default:e(()=>[a(y,{modelValue:g.value.name,"onUpdate:modelValue":l[3]||(l[3]=s=>g.value.name=s),label:"Viloyat nomi",readonly:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})],64))}};export{ma as default};
