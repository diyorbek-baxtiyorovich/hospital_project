import{_ as pe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{a8 as ae,a9 as ge,aq as je,aa as Ve,ab as le,ar as Ie,as as Le,ac as ne,b as e,at as Oe,au as Ye,af as Ge,ag as qe,ai as Xe,Y as Je,av as Ke,aw as Qe,aj as We,ax as Ze,ay as Be,X as E,az as et,aA as de,aB as Q,aC as tt,r as y,w as $,o as j,f as G,e as a,s as k,V as at,a3 as z,$ as H,d as r,t as D,aD as lt,aE as nt,aF as ot,aG as st,aH as it,aI as dt,aJ as ut,D as be,a4 as rt,aK as mt,aL as he,aM as ct,aN as ft,p as q,F as ue,H as Pe,aO as vt,aP as pt,aQ as gt,aR as Vt,aS as re,aT as bt,aU as yt,aV as me,aW as F,a1 as ce,aX as Te,aY as Ue,aZ as fe,c as Fe,x as te,a_ as xt,m as wt}from"./index-C6ew0Dc-.js";import{V as kt}from"./VImg-B4OtRQkU.js";import{c as ye,d as oe,V as X,b as xe}from"./VCard-h-Dk38gb.js";import{V as J,a as p}from"./VRow-DFEFfj3U.js";import{V as R}from"./VDivider-BHSlz9wh.js";import{V as we,a as W}from"./filter-BBDhmrCb.js";import{g as ze}from"./departement.servise-BVnBZ7zq.js";import{a as ke}from"./axios-DkIq-4yk.js";import{g as _t}from"./doctors.servise-BrDs9DfE.js";import{V as ve}from"./VChip-B--6Bg9V.js";import{V as Ct,a as ee}from"./VTabs-BeJdGeli.js";import{V as Dt,a as St}from"./VDataTableVirtual-CmELzhnE.js";import{V as $e}from"./VTooltip-4pAptgvZ.js";import"./VAvatar-Bw4S9iN_.js";import"./VList-BcS13ebf.js";import"./VCheckboxBtn-D_HgVTnU.js";const ht=ae({fluid:{type:Boolean,default:!1},...ge(),...je(),...Ve()},"VContainer"),Re=le()({name:"VContainer",props:ht(),setup(t,x){let{slots:s}=x;const{rtlClasses:_}=Ie(),{dimensionStyles:c}=Le(t);return ne(()=>e(t.tag,{class:["v-container",{"v-container--fluid":t.fluid},_.value,t.class],style:[c.value,t.style]},s)),{}}}),Pt=ae({text:String,...ge(),...Ve()},"VToolbarTitle"),Me=le()({name:"VToolbarTitle",props:Pt(),setup(t,x){let{slots:s}=x;return ne(()=>{const _=!!(s.default||s.text||t.text);return e(t.tag,{class:["v-toolbar-title",t.class],style:t.style},{default:()=>{var c;return[_&&e("div",{class:"v-toolbar-title__placeholder"},[s.text?s.text():t.text,(c=s.default)==null?void 0:c.call(s)])]}})}),{}}}),Tt=[null,"prominent","default","comfortable","compact"],Ut=ae({absolute:Boolean,collapse:Boolean,color:String,density:{type:String,default:"default",validator:t=>Tt.includes(t)},extended:Boolean,extensionHeight:{type:[Number,String],default:48},flat:Boolean,floating:Boolean,height:{type:[Number,String],default:64},image:String,title:String,...Oe(),...ge(),...Ye(),...Ge(),...Ve({tag:"header"}),...qe()},"VToolbar"),$t=le()({name:"VToolbar",props:Ut(),setup(t,x){var f;let{slots:s}=x;const{backgroundColorClasses:_,backgroundColorStyles:c}=Xe(Je(t,"color")),{borderClasses:v}=Ke(t),{elevationClasses:C}=Qe(t),{roundedClasses:V}=We(t),{themeClasses:n}=Ze(t),{rtlClasses:i}=Ie(),h=Be(!!(t.extended||(f=s.extension)!=null&&f.call(s))),S=E(()=>parseInt(Number(t.height)+(t.density==="prominent"?Number(t.height):0)-(t.density==="comfortable"?8:0)-(t.density==="compact"?16:0),10)),w=E(()=>h.value?parseInt(Number(t.extensionHeight)+(t.density==="prominent"?Number(t.extensionHeight):0)-(t.density==="comfortable"?4:0)-(t.density==="compact"?8:0),10):0);return et({VBtn:{variant:"text"}}),ne(()=>{var d;const T=!!(t.title||s.title),g=!!(s.image||t.image),o=(d=s.extension)==null?void 0:d.call(s);return h.value=!!(t.extended||o),e(t.tag,{class:["v-toolbar",{"v-toolbar--absolute":t.absolute,"v-toolbar--collapse":t.collapse,"v-toolbar--flat":t.flat,"v-toolbar--floating":t.floating,[`v-toolbar--density-${t.density}`]:!0},_.value,v.value,C.value,V.value,n.value,i.value,t.class],style:[c.value,t.style]},{default:()=>[g&&e("div",{key:"image",class:"v-toolbar__image"},[s.image?e(de,{key:"image-defaults",disabled:!t.image,defaults:{VImg:{cover:!0,src:t.image}}},s.image):e(kt,{key:"image-img",cover:!0,src:t.image},null)]),e(de,{defaults:{VTabs:{height:Q(S.value)}}},{default:()=>{var I,M,O;return[e("div",{class:"v-toolbar__content",style:{height:Q(S.value)}},[s.prepend&&e("div",{class:"v-toolbar__prepend"},[(I=s.prepend)==null?void 0:I.call(s)]),T&&e(Me,{key:"title",text:t.title},{text:s.title}),(M=s.default)==null?void 0:M.call(s),s.append&&e("div",{class:"v-toolbar__append"},[(O=s.append)==null?void 0:O.call(s)])])]}}),e(de,{defaults:{VTabs:{height:Q(w.value)}}},{default:()=>[e(tt,null,{default:()=>[h.value&&e("div",{class:"v-toolbar__extension",style:{height:Q(w.value)}},[o])]})]})]})}),{contentHeight:S,extensionHeight:w}}}),It={class:"info-value"},Bt={class:"info-value"},Ft={class:"info-value"},zt={class:"info-value"},Rt={class:"info-value"},Mt={class:"info-value"},At={class:"info-value"},Nt={class:"info-value"},Ht={class:"info-value"},Et={class:"info-value"},jt={class:"info-value"},Lt={class:"info-value"},Ot={class:"info-value"},Yt={__name:"infoDataDialog",props:{modelValue:Boolean,data:{type:Object,required:!0}},emits:["update:modelValue"],setup(t,{emit:x}){const s=t,_=x,c=y(s.modelValue);$(()=>s.modelValue,V=>c.value=V),$(c,V=>_("update:modelValue",V));function v(V){return V?new Date(V).toLocaleDateString("ru-RU",{year:"numeric",month:"long",day:"numeric"}):"-"}function C(V){return V?new Date(V).toLocaleString("ru-RU",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-"}return(V,n)=>(j(),G(we,{modelValue:c.value,"onUpdate:modelValue":n[2]||(n[2]=i=>c.value=i),"max-width":"1200",transition:"dialog-bottom-transition"},{default:a(()=>[e(X,null,{default:a(()=>[e($t,{flat:"",color:"primary",dark:""},{default:a(()=>[e(Me,{class:"text-h6 font-weight-medium text-white"},{default:a(()=>n[3]||(n[3]=[k(" Детали приёма ")])),_:1}),e(at),e(z,{variant:"text",icon:"",onClick:n[0]||(n[0]=i=>c.value=!1)},{default:a(()=>[e(H,{color:"white"},{default:a(()=>n[4]||(n[4]=[k("mdi-close")])),_:1})]),_:1})]),_:1}),e(ye,{class:"pa-6"},{default:a(()=>[e(Re,{fluid:""},{default:a(()=>[e(J,null,{default:a(()=>[e(p,{cols:"12"},{default:a(()=>[n[5]||(n[5]=r("div",{class:"text-subtitle-1 font-weight-medium mb-2"}," Информация о пациенте ",-1)),e(R)]),_:1}),e(p,{cols:"12",sm:"6"},{default:a(()=>[n[6]||(n[6]=r("div",{class:"info-label"}," Ф.И.О: ",-1)),r("div",It,D(t.data.patient_fullname),1)]),_:1}),e(p,{cols:"12",sm:"6"},{default:a(()=>[n[7]||(n[7]=r("div",{class:"info-label"}," Дата рождения: ",-1)),r("div",Bt,D(v(t.data.birth_date)),1)]),_:1}),e(p,{cols:"12",sm:"6"},{default:a(()=>[n[8]||(n[8]=r("div",{class:"info-label"}," Телефон: ",-1)),r("div",Ft,D(t.data.phone),1)]),_:1}),e(p,{cols:"12",sm:"6"},{default:a(()=>{var i;return[n[9]||(n[9]=r("div",{class:"info-label"}," Отделение: ",-1)),r("div",zt,D((i=t.data.department)==null?void 0:i.name),1)]}),_:1}),e(p,{cols:"12",sm:"6"},{default:a(()=>[n[10]||(n[10]=r("div",{class:"info-label"}," Врач: ",-1)),r("div",Rt,D(t.data.doctor_name_text),1)]),_:1}),e(p,{cols:"12",sm:"6"},{default:a(()=>[n[11]||(n[11]=r("div",{class:"info-label"}," Дата приёма: ",-1)),r("div",Mt,D(v(t.data.date))+" (Слот №"+D(t.data.slot_no)+") ",1)]),_:1}),e(p,{cols:"12"},{default:a(()=>[n[12]||(n[12]=r("div",{class:"info-label"}," Диагноз: ",-1)),r("div",At,D(t.data.diagnosis),1)]),_:1}),e(p,{cols:"12"},{default:a(()=>[n[13]||(n[13]=r("div",{class:"info-label"}," Цель визита: ",-1)),r("div",Nt,D(t.data.purpose),1)]),_:1})]),_:1}),e(R,{class:"my-4"}),e(J,null,{default:a(()=>[e(p,{cols:"12"},{default:a(()=>[n[14]||(n[14]=r("div",{class:"text-subtitle-1 font-weight-medium mb-2"}," Примечания ",-1)),e(R)]),_:1}),e(p,{cols:"12"},{default:a(()=>[n[15]||(n[15]=r("div",{class:"info-label text-red-darken-2"}," Для главного врача: ",-1)),r("div",Ht,D(t.data.note_for_head),1)]),_:1}),e(p,{cols:"12"},{default:a(()=>[n[16]||(n[16]=r("div",{class:"info-label text-blue-darken-2"}," Заметка для пациента: ",-1)),r("div",Et,D(t.data.note_public),1)]),_:1})]),_:1}),e(R,{class:"my-4"}),e(J,null,{default:a(()=>[e(p,{cols:"12"},{default:a(()=>[n[17]||(n[17]=r("div",{class:"text-subtitle-1 font-weight-medium mb-2"}," Системная информация ",-1)),e(R)]),_:1}),e(p,{cols:"12",sm:"6"},{default:a(()=>[n[18]||(n[18]=r("div",{class:"info-label"}," Создано: ",-1)),r("div",jt,D(C(t.data.created_at)),1)]),_:1}),e(p,{cols:"12",sm:"6"},{default:a(()=>[n[19]||(n[19]=r("div",{class:"info-label"}," Обновлено: ",-1)),r("div",Lt,D(C(t.data.updated_at)),1)]),_:1}),e(p,{cols:"12"},{default:a(()=>{var i,h,S;return[n[20]||(n[20]=r("div",{class:"info-label"}," Пользователь, создавший запись: ",-1)),r("div",Ot,D(((i=t.data.created_by_user)==null?void 0:i.full_name)||"неизвестно")+" "+D(((S=(h=t.data.created_by_user)==null?void 0:h.user)==null?void 0:S.username)||"неизвестно"),1)]}),_:1})]),_:1})]),_:1})]),_:1}),e(R),e(oe,{class:"pa-4 justify-end"},{default:a(()=>[e(z,{variant:"outlined",color:"primary",onClick:n[1]||(n[1]=i=>c.value=!1)},{default:a(()=>n[21]||(n[21]=[k(" Закрыть ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},Gt=pe(Yt,[["__scopeId","data-v-82f578ca"]]),qt=lt("appointments",{state:()=>({headers:[{title:"id",align:"start",key:"id"},{title:"Имя пациента",align:"start",key:"patient_fullname"},{title:"Врач",align:"start",key:"doctor.full_name"},{title:"Отделение",align:"start",key:"department.name"},{title:"Дата",align:"start",key:"date"},{title:"Статус",align:"start",key:"status"},{title:"Действия",align:"end",key:"actions",sortable:!1}]}),actions:{}});async function Xt(t){try{const{data:x}=await ke.get("/v1/appointments/get-list",{params:{department_id:t.department_id,for_date:t.for_date,status:t.status}});return x}catch(x){throw console.error("Appointment fetching error:",x),x}}async function Jt(t){try{return await ke.post("/v1/appointments/add-appointment",t)}catch(x){return x}}async function Kt(t,x){try{return await ke.put(`/v1/appointments/set-status/${t}?status=${x}`)}catch(s){throw console.error("Statusni yangilashda xatolik:",s),s}}const Qt=ae({autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:t=>!isNaN(parseFloat(t))},maxRows:{type:[Number,String],validator:t=>!isNaN(parseFloat(t))},suffix:String,modelModifiers:Object,...nt(),...ot()},"VTextarea"),Wt=le()({name:"VTextarea",directives:{Intersect:st},inheritAttrs:!1,props:Qt(),emits:{"click:control":t=>!0,"mousedown:control":t=>!0,"update:focused":t=>!0,"update:modelValue":t=>!0},setup(t,x){let{attrs:s,emit:_,slots:c}=x;const v=it(t,"modelValue"),{isFocused:C,focus:V,blur:n}=dt(t),i=E(()=>typeof t.counterValue=="function"?t.counterValue(v.value):(v.value||"").toString().length),h=E(()=>{if(s.maxlength)return s.maxlength;if(!(!t.counter||typeof t.counter!="number"&&typeof t.counter!="string"))return t.counter});function S(b,m){var l,u;!t.autofocus||!b||(u=(l=m[0].target)==null?void 0:l.focus)==null||u.call(l)}const w=y(),f=y(),T=Be(""),g=y(),o=E(()=>t.persistentPlaceholder||C.value||t.active);function d(){var b;g.value!==document.activeElement&&((b=g.value)==null||b.focus()),C.value||V()}function I(b){d(),_("click:control",b)}function M(b){_("mousedown:control",b)}function O(b){b.stopPropagation(),d(),re(()=>{v.value="",bt(t["onClick:clear"],b)})}function se(b){var l;const m=b.target;if(v.value=m.value,(l=t.modelModifiers)!=null&&l.trim){const u=[m.selectionStart,m.selectionEnd];re(()=>{m.selectionStart=u[0],m.selectionEnd=u[1]})}}const A=y(),Y=y(+t.rows),K=E(()=>["plain","underlined"].includes(t.variant));ut(()=>{t.autoGrow||(Y.value=+t.rows)});function P(){t.autoGrow&&re(()=>{if(!A.value||!f.value)return;const b=getComputedStyle(A.value),m=getComputedStyle(f.value.$el),l=parseFloat(b.getPropertyValue("--v-field-padding-top"))+parseFloat(b.getPropertyValue("--v-input-padding-top"))+parseFloat(b.getPropertyValue("--v-field-padding-bottom")),u=A.value.scrollHeight,U=parseFloat(b.lineHeight),L=Math.max(parseFloat(t.rows)*U+l,parseFloat(m.getPropertyValue("--v-input-control-height"))),ie=parseFloat(t.maxRows)*U+l||1/0,N=yt(u??0,L,ie);Y.value=Math.floor((N-l)/U),T.value=Q(N)})}be(P),$(v,P),$(()=>t.rows,P),$(()=>t.maxRows,P),$(()=>t.density,P);let B;return $(A,b=>{b?(B=new ResizeObserver(P),B.observe(A.value)):B==null||B.disconnect()}),rt(()=>{B==null||B.disconnect()}),ne(()=>{const b=!!(c.counter||t.counter||t.counterValue),m=!!(b||c.details),[l,u]=mt(s),{modelValue:U,...L}=he.filterProps(t),ie=ct(t);return e(he,q({ref:w,modelValue:v.value,"onUpdate:modelValue":N=>v.value=N,class:["v-textarea v-text-field",{"v-textarea--prefixed":t.prefix,"v-textarea--suffixed":t.suffix,"v-text-field--prefixed":t.prefix,"v-text-field--suffixed":t.suffix,"v-textarea--auto-grow":t.autoGrow,"v-textarea--no-resize":t.noResize||t.autoGrow,"v-input--plain-underlined":K.value},t.class],style:t.style},l,L,{centerAffix:Y.value===1&&!K.value,focused:C.value}),{...c,default:N=>{let{id:Z,isDisabled:_e,isDirty:Ce,isReadonly:Ae,isValid:Ne}=N;return e(ft,q({ref:f,style:{"--v-textarea-control-height":T.value},onClick:I,onMousedown:M,"onClick:clear":O,"onClick:prependInner":t["onClick:prependInner"],"onClick:appendInner":t["onClick:appendInner"]},ie,{id:Z.value,active:o.value||Ce.value,centerAffix:Y.value===1&&!K.value,dirty:Ce.value||t.dirty,disabled:_e.value,focused:C.value,error:Ne.value===!1}),{...c,default:He=>{let{props:{class:De,...Se}}=He;return e(ue,null,[t.prefix&&e("span",{class:"v-text-field__prefix"},[t.prefix]),Pe(e("textarea",q({ref:g,class:De,value:v.value,onInput:se,autofocus:t.autofocus,readonly:Ae.value,disabled:_e.value,placeholder:t.placeholder,rows:t.rows,name:t.name,onFocus:d,onBlur:n},Se,u),null),[[vt("intersect"),{handler:S},null,{once:!0}]]),t.autoGrow&&Pe(e("textarea",{class:[De,"v-textarea__sizer"],id:`${Se.id}-sizer`,"onUpdate:modelValue":Ee=>v.value=Ee,ref:A,readonly:!0,"aria-hidden":"true"},null),[[pt,v.value]]),t.suffix&&e("span",{class:"v-text-field__suffix"},[t.suffix])])}})},details:m?N=>{var Z;return e(ue,null,[(Z=c.details)==null?void 0:Z.call(c,N),b&&e(ue,null,[e("span",null,null),e(gt,{active:t.persistentCounter||C.value,value:i.value,max:h.value,disabled:t.disabled},c.counter)])])}:void 0})}),Vt({},w,f,g)}}),Zt={class:"text-h6 text-white font-weight-bold"},ea={__name:"addDataDialog",props:{modelValue:Boolean},emits:["update:modelValue","submit"],setup(t,{emit:x}){const s=t,_=x,c=y(s.modelValue);$(()=>s.modelValue,g=>c.value=g),$(c,g=>_("update:modelValue",g));const v=y(!1),C=y(!1),V=y([]),n=y([]),i=me({department_id:null,date:new Date,slot_no:null,doctor_id:null,patient_fullname:"",birth_date:null,diagnosis:"",phone:"",purpose:"",doctor_name_text:"",note_for_head:"",note_public:""});async function h(){try{V.value=await _t()}catch(g){console.error("Ошибка при получении списка врачей:",g)}}async function S(){try{n.value=await ze()}catch(g){console.log("Departamentlar yuklanishda xatolik yuz berdi",g)}}function w(g){if(!g)return"";const o=new Date(g),d=o.getFullYear(),I=String(o.getMonth()+1).padStart(2,"0"),M=String(o.getDate()).padStart(2,"0");return`${d}-${I}-${M}`}function f(){c.value=!1}function T(){const g={...i,date:w(i.date),birth_date:w(i.birth_date)};_("submit",g),f()}return be(()=>{h(),S()}),(g,o)=>(j(),G(we,{modelValue:c.value,"onUpdate:modelValue":o[18]||(o[18]=d=>c.value=d),"max-width":"800",persistent:"",transition:"dialog-bottom-transition"},{default:a(()=>[e(X,{class:"rounded-2xl elevation-6"},{default:a(()=>[e(xe,{class:"d-flex justify-space-between align-center py-4 px-6 bg-primary rounded-t-2xl"},{default:a(()=>[r("span",Zt,[e(H,null,{default:a(()=>o[19]||(o[19]=[k("mdi-stethoscope")])),_:1}),o[20]||(o[20]=k(" Добавить данные нового приёма "))]),e(z,{icon:"mdi-close",variant:"text",color:"white",onClick:f})]),_:1}),e(ye,{class:"py-6 px-6"},{default:a(()=>[e(Re,null,{default:a(()=>[e(J,{dense:""},{default:a(()=>[e(p,{cols:"12",md:"6"},{default:a(()=>[e(F,{modelValue:i.patient_fullname,"onUpdate:modelValue":o[0]||(o[0]=d=>i.patient_fullname=d),label:"👤 Ф.И.О. пациента",variant:"outlined",density:"comfortable",clearable:"",required:""},null,8,["modelValue"])]),_:1}),e(p,{cols:"12",md:"6"},{default:a(()=>[e(F,{modelValue:i.phone,"onUpdate:modelValue":o[1]||(o[1]=d=>i.phone=d),label:"📞 Номер телефона",type:"tel",variant:"outlined",density:"comfortable",clearable:""},null,8,["modelValue"])]),_:1}),e(p,{cols:"12",md:"6"},{default:a(()=>[e(ce,{modelValue:v.value,"onUpdate:modelValue":o[5]||(o[5]=d=>v.value=d),"close-on-content-click":!1,transition:"scale-transition","offset-y":"","min-width":"290px"},{activator:a(({props:d})=>[r("div",Te(Ue(d)),[e(F,{"model-value":w(i.birth_date),label:"🎂 Дата рождения",variant:"outlined",density:"comfortable",readonly:"",clearable:"","prepend-inner-icon":"mdi-cake-variant","onClick:clear":o[2]||(o[2]=I=>i.birth_date=null)},null,8,["model-value"])],16)]),default:a(()=>[e(fe,{modelValue:i.birth_date,"onUpdate:modelValue":[o[3]||(o[3]=d=>i.birth_date=d),o[4]||(o[4]=d=>v.value=!1)],color:"primary"},null,8,["modelValue"])]),_:1},8,["modelValue"])]),_:1}),e(p,{cols:"12",md:"6"},{default:a(()=>[e(ce,{modelValue:C.value,"onUpdate:modelValue":o[9]||(o[9]=d=>C.value=d),"close-on-content-click":!1,transition:"scale-transition","offset-y":"","min-width":"290px"},{activator:a(({props:d})=>[r("div",Te(Ue(d)),[e(F,{"model-value":w(i.date),label:"📅 Дата приёма",variant:"outlined",density:"comfortable",readonly:"",clearable:"","prepend-inner-icon":"mdi-calendar","onClick:clear":o[6]||(o[6]=I=>i.date=null)},null,8,["model-value"])],16)]),default:a(()=>[e(fe,{modelValue:i.date,"onUpdate:modelValue":[o[7]||(o[7]=d=>i.date=d),o[8]||(o[8]=d=>C.value=!1)],color:"primary"},null,8,["modelValue"])]),_:1},8,["modelValue"])]),_:1}),e(p,{cols:"12",md:"6"},{default:a(()=>[e(F,{modelValue:i.doctor_name_text,"onUpdate:modelValue":o[10]||(o[10]=d=>i.doctor_name_text=d),label:"👨‍⚕️ Врач (текст)",variant:"outlined",density:"comfortable"},null,8,["modelValue"])]),_:1}),e(p,{cols:"12",md:"6"},{default:a(()=>[e(F,{modelValue:i.diagnosis,"onUpdate:modelValue":o[11]||(o[11]=d=>i.diagnosis=d),label:"🧠 Диагноз",variant:"outlined",density:"comfortable"},null,8,["modelValue"])]),_:1}),e(p,{cols:"12",md:"6"},{default:a(()=>[e(F,{modelValue:i.purpose,"onUpdate:modelValue":o[12]||(o[12]=d=>i.purpose=d),label:"🎯 Цель приёма",variant:"outlined",density:"comfortable"},null,8,["modelValue"])]),_:1}),e(p,{cols:"12",md:"6"},{default:a(()=>[e(F,{modelValue:i.note_public,"onUpdate:modelValue":o[13]||(o[13]=d=>i.note_public=d),label:"📝 Общий комментарий",variant:"outlined",density:"comfortable"},null,8,["modelValue"])]),_:1}),e(p,{cols:"12"},{default:a(()=>[e(Wt,{modelValue:i.note_for_head,"onUpdate:modelValue":o[14]||(o[14]=d=>i.note_for_head=d),label:"📋 Комментарий для руководителя",variant:"outlined","auto-grow":"",rows:"2",clearable:""},null,8,["modelValue"])]),_:1}),e(p,{cols:"12",md:"4"},{default:a(()=>[e(W,{modelValue:i.department_id,"onUpdate:modelValue":o[15]||(o[15]=d=>i.department_id=d),items:n.value,"item-title":"name","item-value":"id",label:"🏢 Отделение",variant:"outlined",density:"comfortable",clearable:"","prepend-inner-icon":"mdi-office-building"},null,8,["modelValue","items"])]),_:1}),e(p,{cols:"12",md:"4"},{default:a(()=>[e(W,{modelValue:i.doctor_id,"onUpdate:modelValue":o[16]||(o[16]=d=>i.doctor_id=d),items:V.value,"item-title":"full_name","item-value":"id",label:"👨‍⚕️ Врач",variant:"outlined",density:"comfortable",clearable:"","prepend-inner-icon":"mdi-stethoscope"},null,8,["modelValue","items"])]),_:1}),e(p,{cols:"12",md:"4"},{default:a(()=>[e(F,{modelValue:i.slot_no,"onUpdate:modelValue":o[17]||(o[17]=d=>i.slot_no=d),modelModifiers:{number:!0},label:"⏰ Номер слота",type:"number",variant:"outlined",density:"comfortable"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(oe,{class:"px-6 pb-6 d-flex justify-end"},{default:a(()=>[e(z,{variant:"tonal",color:"grey",class:"mr-3",onClick:f},{default:a(()=>o[21]||(o[21]=[k(" Отмена ")])),_:1}),e(z,{color:"primary",class:"px-6","prepend-icon":"mdi-content-save",onClick:T},{default:a(()=>o[22]||(o[22]=[k(" Сохранить ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},ta=pe(ea,[["__scopeId","data-v-f30528ac"]]),aa={class:"mb-3"},la={class:"mt-2"},na={key:0,class:"mt-4 text-center"},oa={__name:"changeStatus",props:{modelValue:Boolean,currentTab:String,item:Object},emits:["update:modelValue","update-status"],setup(t,{emit:x}){const s=t,_=x,c=E({get:()=>s.modelValue,set:w=>_("update:modelValue",w)}),v=y(null),C=E(()=>({planned:[{label:"Допущен",value:"admitted"},{label:"Отменён",value:"canceled"}],admitted:[{label:"Госпитализирован",value:"hospitalized"},{label:"Отменён",value:"canceled"}],hospitalized:[{label:"Отменён",value:"canceled"}],canceled:[{label:"Планируется",value:"planned"}]})[s.currentTab]||[]),V=()=>{v.value&&(_("update-status",{id:s.item.id,status:v.value}),n())},n=()=>{_("update:modelValue",!1),v.value=null};function i(w){switch(w){case"planned":return"blue";case"admitted":return"green";case"hospitalized":return"deep-purple";case"canceled":return"red";default:return"grey"}}function h(w){switch(w){case"planned":return"mdi-calendar-clock";case"admitted":return"mdi-check-circle";case"hospitalized":return"mdi-hospital-building";case"canceled":return"mdi-cancel";default:return"mdi-help-circle"}}function S(w){switch(w){case"planned":return"Планируется";case"admitted":return"Допущен";case"hospitalized":return"Госпитализирован";case"canceled":return"Отменён";default:return"Неизвестно"}}return(w,f)=>(j(),G(we,{modelValue:c.value,"onUpdate:modelValue":f[1]||(f[1]=T=>c.value=T),"max-width":"450",transition:"dialog-bottom-transition",persistent:""},{default:a(()=>[e(X,{class:"pa-3 rounded-xl elevation-3"},{default:a(()=>[e(xe,{class:"d-flex align-center mb-1"},{default:a(()=>[e(H,{color:"primary",size:"28",class:"mr-2"},{default:a(()=>f[2]||(f[2]=[k("mdi-autorenew")])),_:1}),f[3]||(f[3]=r("span",{class:"text-h6 font-weight-bold"},"Изменить статус",-1))]),_:1}),e(R,{class:"my-2"}),e(ye,null,{default:a(()=>[r("div",aa,[f[4]||(f[4]=r("span",{class:"text-subtitle-2 text-medium-emphasis"},"Текущий статус:",-1)),r("div",la,[e(ve,{color:i(t.item.status),class:"font-weight-medium","text-color":"white",size:"small"},{default:a(()=>[e(H,{start:"",small:""},{default:a(()=>[k(D(h(t.item.status)),1)]),_:1}),k(" "+D(S(t.item.status)),1)]),_:1},8,["color"])])]),e(W,{modelValue:v.value,"onUpdate:modelValue":f[0]||(f[0]=T=>v.value=T),items:C.value,"item-title":"label","item-value":"value",label:"Выберите новый статус",density:"comfortable",variant:"outlined",clearable:"",class:"rounded-lg","prepend-inner-icon":"mdi-flag-outline"},null,8,["modelValue","items"]),v.value?(j(),Fe("div",na,[f[5]||(f[5]=r("span",{class:"text-body-2 mb-2 d-block"},"Выбранный статус:",-1)),e(ve,{color:i(v.value),size:"large","text-color":"white",class:"font-weight-bold px-4"},{default:a(()=>[e(H,{start:"",small:""},{default:a(()=>[k(D(h(v.value)),1)]),_:1}),k(" "+D(S(v.value)),1)]),_:1},8,["color"])])):te("",!0)]),_:1}),e(R,{class:"my-2"}),e(oe,{class:"justify-end"},{default:a(()=>[e(z,{variant:"text",color:"error",onClick:n},{default:a(()=>[e(H,{start:"",small:""},{default:a(()=>f[6]||(f[6]=[k("mdi-close-circle")])),_:1}),f[7]||(f[7]=k(" Отмена "))]),_:1}),e(z,{color:"primary",class:"px-4",disabled:!v.value,onClick:V},{default:a(()=>[e(H,{start:"",small:""},{default:a(()=>f[8]||(f[8]=[k("mdi-check-circle")])),_:1}),f[9]||(f[9]=k(" Сохранить "))]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},sa=pe(oa,[["__scopeId","data-v-b0add185"]]),ia={class:"ma-2",flat:""},da={class:"d-flex"},Sa={__name:"index",setup(t){const x=qt(),s=xt(),_=y(!1),c=y(null),v=y(null),C=y(!1),V=y("planned"),n=y(!1),i=me({page:1,itemsPerPage:10}),h=y(0),S=y(!1),w=y(null),f=y([]),T=y([]),g=me({department_id:null,for_date:null,status:V.value}),o=y(!1),d=y([]);function I(m){switch(m){case"planned":return"blue";case"admitted":return"green";case"hospitalized":return"deep-purple";case"canceled":return"red";default:return"grey"}}function M(m){switch(m){case"planned":return"mdi-calendar-clock";case"admitted":return"mdi-check-circle";case"hospitalized":return"mdi-hospital-building";case"canceled":return"mdi-cancel";default:return"mdi-help-circle"}}function O(m){switch(m){case"planned":return"Планируется";case"admitted":return"Допущен";case"hospitalized":return"Госпитализирован";case"canceled":return"Отменено";default:return"Неизвестно"}}const se=m=>{if(!m)return;const l=new Date(m),u=l.getFullYear(),U=String(l.getMonth()+1).padStart(2,"0"),L=String(l.getDate()).padStart(2,"0");c.value=`${u}-${U}-${L}`,g.for_date=c.value,_.value=!1},A=m=>{w.value=m,n.value=!0},Y=m=>{T.value=m,S.value=!0},K=async()=>{try{d.value=await ze(),d.value.length>0&&(g.department_id=d.value[0].id),await P()}catch(m){console.error("Ошибка при загрузке департаментов:",m),s.error("Ошибка при загрузке департаментов: ❌")}},P=async()=>{o.value=!0;const m={department_id:g.department_id,for_date:g.for_date,status:g.status};try{f.value=await Xt(m)}catch(l){console.error("Data loading error",l)}finally{o.value=!1}},B=async m=>{try{await Jt(m),s.success("Приём успешно добавлен ✅"),await P()}catch(l){console.error("Ошибка при добавлении приёма:",l),s.error("Ошибка при сохранении ❌")}},b=async({id:m,status:l})=>{try{await Kt(m,l),await P(),s.success("Status muvaffaqiyatli yangilandi ✅")}catch(u){console.error("Ошибка при обновлении статуса:",u),s.error("Ошибка при обновлении статуса ❌")}};return be(()=>{K()}),$(V,async m=>{g.status=m,await P()}),$(()=>g.department_id,(m,l)=>{m!==l&&P()}),$(()=>g.for_date,(m,l)=>{m!==l&&P()}),(m,l)=>(j(),Fe("div",null,[r("div",ia,[e(X,{class:"mb-2 text-xl"},{default:a(()=>[e(Ct,{modelValue:V.value,"onUpdate:modelValue":l[0]||(l[0]=u=>V.value=u),color:"primary",grow:""},{default:a(()=>[e(ee,{value:"planned"},{default:a(()=>l[11]||(l[11]=[k(" Планируется ")])),_:1}),e(ee,{value:"admitted"},{default:a(()=>l[12]||(l[12]=[k(" Допущенный ")])),_:1}),e(ee,{value:"hospitalized"},{default:a(()=>l[13]||(l[13]=[k(" Госпитализирован ")])),_:1}),e(ee,{value:"canceled"},{default:a(()=>l[14]||(l[14]=[k(" Отменено ")])),_:1})]),_:1},8,["modelValue"])]),_:1}),e(X,{class:"mb-3 py-1",flat:""},{default:a(()=>[e(J,{class:"pa-2 align-center"},{default:a(()=>[e(xe,{class:"mr-4"},{default:a(()=>l[15]||(l[15]=[r("span",null,"📊 Общая информация",-1)])),_:1}),e(p,{cols:"12",md:"3"},{default:a(()=>[e(W,{modelValue:g.department_id,"onUpdate:modelValue":l[1]||(l[1]=u=>g.department_id=u),label:"Departament",items:d.value,"item-title":"name","item-value":"id",clearable:""},null,8,["modelValue","items"])]),_:1}),e(p,{cols:"12",md:"3"},{default:a(()=>[e(ce,{modelValue:_.value,"onUpdate:modelValue":l[4]||(l[4]=u=>_.value=u),"close-on-content-click":!1,transition:"scale-transition","offset-y":"","min-width":"auto"},{activator:a(({props:u})=>[e(F,q({modelValue:c.value,"onUpdate:modelValue":l[2]||(l[2]=U=>c.value=U),label:"Дата (YYYY-MM-DD)"},u,{"prepend-inner-icon":"mdi-calendar",placeholder:"2025-10-14",clearable:""}),null,16,["modelValue"])]),default:a(()=>[e(fe,{modelValue:v.value,"onUpdate:modelValue":[l[3]||(l[3]=u=>v.value=u),se],color:"primary"},null,8,["modelValue"])]),_:1},8,["modelValue"])]),_:1}),e(p,{cols:"12",md:"3",class:"d-flex justify-end"},{default:a(()=>[e(z,{color:"primary",onClick:l[5]||(l[5]=u=>C.value=!0)},{default:a(()=>l[16]||(l[16]=[k(" Добавить информацию ")])),_:1})]),_:1})]),_:1})]),_:1}),e(J,{dense:""},{default:a(()=>[e(p,{cols:"12"},{default:a(()=>[e(X,{flat:""},{default:a(()=>[e(R),e(Dt,{headers:wt(x).headers,items:f.value,loading:o.value,height:"70vh","loading-text":"Загрузка...","no-data-text":"Данные не найдены"},{"item.status":a(({item:u})=>[e(ve,{color:I(u.status),"text-color":"white",size:"small",class:"font-weight-medium"},{default:a(()=>[e(H,{start:"",small:""},{default:a(()=>[k(D(M(u.status)),1)]),_:2},1024),k(" "+D(O(u.status)),1)]),_:2},1032,["color"])]),"item.actions":a(({item:u})=>[r("div",da,[e($e,{text:"Просмотр",location:"top"},{activator:a(({props:U})=>[e(z,q(U,{icon:"mdi-eye-outline",variant:"plain",color:"info",onClick:L=>Y(u)}),null,16,["onClick"])]),_:2},1024),e($e,{text:"Изменить статус",location:"top"},{activator:a(({props:U})=>[e(z,q(U,{icon:"mdi-atom-variant",variant:"plain",color:"warning",onClick:L=>A(u)}),null,16,["onClick"])]),_:2},1024)])]),_:1},8,["headers","items","loading"]),e(oe,{class:"w-full d-flex justify-space-between mt-2"},{default:a(()=>[e(W,{modelValue:i.itemsPerPage,"onUpdate:modelValue":[l[6]||(l[6]=u=>i.itemsPerPage=u),P],items:[10,20,50],label:"Каждая страница","max-width":"150"},null,8,["modelValue"]),e(St,{modelValue:i.page,"onUpdate:modelValue":[l[7]||(l[7]=u=>i.page=u),P],length:Math.ceil(h.value/i.itemsPerPage),"total-visible":4,rounded:"circle"},null,8,["modelValue","length"])]),_:1})]),_:1})]),_:1})]),_:1})]),S.value?(j(),G(Gt,{key:0,modelValue:S.value,"onUpdate:modelValue":l[8]||(l[8]=u=>S.value=u),data:T.value},null,8,["modelValue","data"])):te("",!0),C.value?(j(),G(ta,{key:1,modelValue:C.value,"onUpdate:modelValue":l[9]||(l[9]=u=>C.value=u),departament:d.value,onSubmit:B},null,8,["modelValue","departament"])):te("",!0),n.value?(j(),G(sa,{key:2,modelValue:n.value,"onUpdate:modelValue":l[10]||(l[10]=u=>n.value=u),item:w.value,"current-tab":V.value,onUpdateStatus:b},null,8,["modelValue","item","current-tab"])):te("",!0)]))}};export{Sa as default};
