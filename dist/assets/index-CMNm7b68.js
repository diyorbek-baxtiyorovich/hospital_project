import{aq as X,ar as $,r as m,o as q,c as h,b as e,e as t,s as v,a3 as y,a2 as N,as as b,w as E,f as w,x as T,D as O,F as P,m as z,Z as L,t as Z,d as G,V as H}from"./index-ugE2diwG.js";import{a as J,g as Q,u as W,b as Y,d as ee}from"./districtService-EQQDz5NY.js";import{g as ae}from"./regionService-C0wOXPfj.js";import{V as U,b as _,d as M}from"./VCard-SX4cXtR7.js";import{V as F}from"./VDivider-Bpjbs-Pq.js";import{V as A}from"./VForm-ChxjC397.js";import{V as j,a as g}from"./VRow-36agrQek.js";import{V as R}from"./VAutocomplete-Dm7y-anX.js";import{V as I}from"./VDialog-CIam9dbg.js";import{V as le}from"./VDataTableVirtual-Bf3SGZG3.js";import"./axios-BhI_j3KQ.js";import"./VAvatar-B0HJojTh.js";import"./VImg-B0R5TV1H.js";import"./filter-BnwPlqYj.js";import"./VList-DuunN5-t.js";import"./VChip-BHX79YCc.js";const te=X("district",{state:()=>({headers:[{title:"№",align:"start",key:"id",sortable:!1},{title:"Tuman kodi",align:"start",key:"code"},{title:"Tuman nomi",align:"start",key:"name"},{title:"Viloyat",align:"start",key:"region.name"},{title:"Sozlamalar",align:"end",key:"actions",sortable:!1}]}),actions:{}}),ie={class:"text-center"},ue={__name:"CreateDistrict",props:{regionsList:Array},emits:["created"],setup(C,{emit:x}){const c=x,V=$(),n=m({name_uz:null,name_ru:null,code:null,region_id:null}),f=m(!1),o=m(null);async function D(){const{valid:d}=await o.value.validate();if(!d)return;const l=await J(n.value);(l==null?void 0:l.status)===200?(V.success("Muvofaqqiyatli yaratildi."),c("created"),o.value.reset(),f.value=!1):V.error("Xatolik yuz berdi!")}const k=d=>{const l=String.fromCharCode(d.keyCode);if(/^\d*$/.test(l))return!0;d.preventDefault()};return(d,l)=>(q(),h("div",ie,[e(y,{class:"ml-3",onClick:l[0]||(l[0]=a=>f.value=!0)},{default:t(()=>l[8]||(l[8]=[v(" qo'shish ")])),_:1}),e(I,{modelValue:f.value,"onUpdate:modelValue":l[7]||(l[7]=a=>f.value=a),"max-width":"800"},{default:t(()=>[e(U,{class:"pa-4"},{default:t(()=>[e(_,null,{default:t(()=>l[9]||(l[9]=[v(" Tuman yaratish ")])),_:1}),e(F,{class:"mb-4"}),e(A,{ref_key:"form",ref:o,onSubmit:N(D,["prevent"])},{default:t(()=>[e(j,null,{default:t(()=>[e(g,{cols:"12",md:"6"},{default:t(()=>[e(b,{modelValue:n.value.name_uz,"onUpdate:modelValue":l[1]||(l[1]=a=>n.value.name_uz=a),rules:[a=>!!a||"to'ldirish majburiy!",a=>a&&a.length>=3||"Viloyat nomi kamida 3 harfdan iborat bo'lishi zarur"],label:"Tuman nomi (uz)",required:""},null,8,["modelValue","rules"])]),_:1}),e(g,{cols:"12",md:"6"},{default:t(()=>[e(b,{modelValue:n.value.name_ru,"onUpdate:modelValue":l[2]||(l[2]=a=>n.value.name_ru=a),rules:[a=>!!a||"to'ldirish majburiy!",a=>a&&a.length>=3||"Tuman nomi kamida 3 harfdan iborat bo'lishi zarur"],label:"Название района (ru)",required:""},null,8,["modelValue","rules"])]),_:1}),e(g,{cols:"12",md:"6"},{default:t(()=>[e(b,{modelValue:n.value.code,"onUpdate:modelValue":l[3]||(l[3]=a=>n.value.code=a),rules:[a=>!!a||"to'ldirish majburiy!",a=>a&&a.length>=3||"Tuman kodi kamida 3 raqamdan iborat bo'lishi zarur"],label:"Tuman kodi",required:"",onKeypress:l[4]||(l[4]=a=>k(a))},null,8,["modelValue","rules"])]),_:1}),e(g,{cols:"12",md:"6"},{default:t(()=>[e(R,{modelValue:n.value.region_id,"onUpdate:modelValue":l[5]||(l[5]=a=>n.value.region_id=a),items:C.regionsList,rules:[a=>!!a||"to'ldirish majburiy!"],clearable:"","item-title":"name","item-value":"id",label:"Tuman kodi",required:""},null,8,["modelValue","items","rules"])]),_:1})]),_:1}),e(M,{class:"d-flex w-full justify-end mt-4"},{default:t(()=>[e(y,{color:"error",variant:"elevated",onClick:l[6]||(l[6]=a=>f.value=!1)},{default:t(()=>l[10]||(l[10]=[v(" bekor qilish ")])),_:1}),e(y,{color:"success",type:"submit",variant:"elevated"},{default:t(()=>l[11]||(l[11]=[v(" saqlash ")])),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1},8,["modelValue"])]))}},oe={class:"text-center"},se={__name:"updateDistrict",props:{regionsList:Array,updatingItem:Object,updateDialog:{type:Boolean,default:!1}},emits:["updated","update:updateDialog"],setup(C,{emit:x}){const c=C,V=x;function n(){V("update:updateDialog",!1)}const f=$(),o=m(null),D=m(null);async function k(){var u,i;const a=await Q(c.updatingItem.id);a&&(o.value=a,o.value.region.name=(i=(u=o.value)==null?void 0:u.region)==null?void 0:i.name_uz)}async function d(){const{valid:a}=await D.value.validate();if(!a)return;o.value.region_id=o.value.region.id;const u=await W(c.updatingItem.id,o.value);(u==null?void 0:u.status)===200?(f.success("Muvofaqqiyatli yaratildi."),V("update:updateDialog",!1),V("updated"),D.value.reset()):f.error("Xatolik yuz berdi")}const l=a=>{const u=String.fromCharCode(a.keyCode);if(/^\d*$/.test(u))return!0;a.preventDefault()};return E(()=>c.updateDialog,a=>{k()}),(a,u)=>(q(),h("div",oe,[e(I,{modelValue:c.updateDialog,"onUpdate:modelValue":u[5]||(u[5]=i=>c.updateDialog=i),"max-width":"800"},{default:t(()=>[e(U,{class:"pa-4"},{default:t(()=>[e(_,null,{default:t(()=>u[6]||(u[6]=[v(" Viloyat yaratish ")])),_:1}),e(F,{class:"mb-4"}),o.value?(q(),w(A,{key:0,ref_key:"form",ref:D,onSubmit:N(d,["prevent"])},{default:t(()=>[e(j,null,{default:t(()=>[e(g,{cols:"12",md:"6"},{default:t(()=>[e(b,{modelValue:o.value.name_uz,"onUpdate:modelValue":u[0]||(u[0]=i=>o.value.name_uz=i),rules:[i=>!!i||"to'ldirish majburiy!",i=>i&&i.length>=3||"Viloyat nomi kamida 3 harfdan iborat bo'lishi zarur"],label:"Tuman nomi (uz)",required:""},null,8,["modelValue","rules"])]),_:1}),e(g,{cols:"12",md:"6"},{default:t(()=>[e(b,{modelValue:o.value.name_ru,"onUpdate:modelValue":u[1]||(u[1]=i=>o.value.name_ru=i),rules:[i=>!!i||"to'ldirish majburiy!",i=>i&&i.length>=3||"Tuman nomi kamida 3 harfdan iborat bo'lishi zarur"],label:"Название района (ru)",required:""},null,8,["modelValue","rules"])]),_:1}),e(g,{cols:"12",md:"6"},{default:t(()=>[e(b,{modelValue:o.value.code,"onUpdate:modelValue":u[2]||(u[2]=i=>o.value.code=i),rules:[i=>!!i||"to'ldirish majburiy!",i=>i&&i.length>=3||"Tuman kodi kamida 3 raqamdan iborat bo'lishi zarur"],label:"Tuman kodi",required:"",onKeypress:u[3]||(u[3]=i=>l(i))},null,8,["modelValue","rules"])]),_:1}),e(g,{cols:"12",md:"6"},{default:t(()=>[e(R,{modelValue:o.value.region,"onUpdate:modelValue":u[4]||(u[4]=i=>o.value.region=i),items:C.regionsList,rules:[i=>!!i||"to'ldirish majburiy!"],clearable:"","item-title":"name",label:"Tuman kodi",required:"","return-object":""},null,8,["modelValue","items","rules"])]),_:1})]),_:1}),e(M,{class:"d-flex w-full justify-end mt-4"},{default:t(()=>[e(y,{color:"error",variant:"elevated",onClick:n},{default:t(()=>u[7]||(u[7]=[v(" bekor qilish ")])),_:1}),e(y,{color:"success",type:"submit",variant:"elevated"},{default:t(()=>u[8]||(u[8]=[v(" saqlash ")])),_:1})]),_:1})]),_:1},512)):T("",!0)]),_:1})]),_:1},8,["modelValue"])]))}},xe={__name:"index",setup(C){const x=$(),c=te(),V=m(!1),n=m([]),f=m([]),o=m(null);async function D(){const p=await ae();p&&(f.value=p)}async function k(){V.value=!0;const p=await Y();V.value=!1,p&&(n.value=p)}const d=m(!1),l=m(null),a=m(!1);function u(p){l.value=p,d.value=!0}async function i(){a.value=!0;const p=await ee(l.value.id);a.value=!1,p.status===200&&x.success("Muvofaqqiyatli o'chirildi"),d.value=!1,await k()}const B=m(!1);function K(p){l.value=null,l.value=p,B.value=!0}return O(()=>{k(),D()}),(p,s)=>(q(),h(P,null,[e(se,{"update-dialog":B.value,"onUpdate:updateDialog":s[0]||(s[0]=r=>B.value=r),"regions-list":f.value,"updating-item":l.value,onUpdated:k},null,8,["update-dialog","regions-list","updating-item"]),e(U,{flat:""},{default:t(()=>[e(j,{class:"ma-2"},{default:t(()=>[e(g,{cols:"12",md:"6"},{default:t(()=>[e(_,{class:"d-flex align-center pe-2"},{default:t(()=>s[7]||(s[7]=[v(" Tumanlar ro'yxati ")])),_:1})]),_:1}),e(g,{class:"d-flex",cols:"12",md:"6"},{default:t(()=>[e(b,{modelValue:o.value,"onUpdate:modelValue":s[1]||(s[1]=r=>o.value=r),density:"compact","hide-details":"",label:"qidirish...","prepend-inner-icon":"mdi-magnify"},null,8,["modelValue"]),z(L)("/district/v1/create")?(q(),w(ue,{key:0,"regions-list":f.value,onCreated:k},null,8,["regions-list"])):T("",!0)]),_:1})]),_:1}),e(F),e(le,{search:o.value,"onUpdate:search":s[2]||(s[2]=r=>o.value=r),"filter-keys":["name_uz","name_ru"],headers:z(c).headers,items:n.value,loading:V.value,"fixed-header":"",height:"71vh","loading-text":"ma'lumotlar yuklanmoqda","no-data-text":"ma'lumot topilmadi"},{"item.id":t(({item:r,index:S})=>[v(Z(S+1),1)]),"item.actions":t(({item:r})=>[G("div",null,[z(L)("/district/v1/update")?(q(),w(y,{key:0,color:"warning",density:"default",icon:"mdi-pencil-circle",size:"x-large",variant:"plain",onClick:S=>K(r)},null,8,["onClick"])):T("",!0),z(L)("/district/v1/delete")?(q(),w(y,{key:1,color:"error",density:"default",icon:"mdi-delete",size:"x-large",variant:"plain",onClick:S=>u(r)},null,8,["onClick"])):T("",!0)])]),_:1},8,["search","headers","items","loading"]),e(I,{modelValue:d.value,"onUpdate:modelValue":s[6]||(s[6]=r=>d.value=r),"max-width":"800",persistent:""},{default:t(()=>[e(U,{class:"pa-4"},{actions:t(()=>[e(H),e(y,{color:"success",onClick:s[5]||(s[5]=r=>d.value=!1)},{default:t(()=>s[9]||(s[9]=[v(" Bekor qilish ")])),_:1}),e(y,{loading:a.value,color:"error",onClick:i},{default:t(()=>s[10]||(s[10]=[v(" Tasdiqlash ")])),_:1},8,["loading"])]),default:t(()=>[e(_,{class:"text-center mb-4 font-weight-bold"},{default:t(()=>s[8]||(s[8]=[v(" Ushbu ma'lumotni o'chirishni tasdiqlaysizmi? ")])),_:1}),e(j,{class:"mb-4"},{default:t(()=>[e(g,{cols:"12",md:"6"},{default:t(()=>[e(b,{modelValue:l.value.name_uz,"onUpdate:modelValue":s[3]||(s[3]=r=>l.value.name_uz=r),label:"Tuman nomi (uz)",readonly:""},null,8,["modelValue"])]),_:1}),e(g,{cols:"12",md:"6"},{default:t(()=>[e(b,{modelValue:l.value.name_ru,"onUpdate:modelValue":s[4]||(s[4]=r=>l.value.name_ru=r),label:"Название района (ru)",readonly:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})],64))}};export{xe as default};
