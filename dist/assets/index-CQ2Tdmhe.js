import{_ as fe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{a8 as ae,a9 as ve,aq as Ae,aa as ge,ab as le,ar as Te,as as Ne,ac as ne,b as e,at as He,au as Ee,af as Ye,ag as je,ai as Le,Y as Oe,av as Ge,aw as qe,aj as We,ax as Xe,ay as Pe,X as N,az as Je,aA as de,aB as K,aC as Ke,r as V,w as $,o as H,f as G,e as a,s as _,V as Qe,a3 as F,$ as A,d as r,t as h,aD as Ze,aE as et,aF as tt,aG as at,aH as lt,aI as nt,aJ as ot,D as pe,a4 as st,aK as it,aL as De,aM as dt,aN as ut,p as q,F as ue,H as Ce,aO as rt,aP as mt,aQ as ct,aR as ft,aS as re,aT as vt,aU as gt,aV as me,aW as B,c as Ue,x as te,aX as pt,a1 as bt,aY as Vt,m as yt}from"./index-Psq43fdt.js";import{V as xt}from"./VImg-Cq_Frsvh.js";import{c as be,d as oe,V as W,b as Ve}from"./VCard-BXEULYPC.js";import{V as X,a as p}from"./VRow-CFYAQaPO.js";import{V as z}from"./VDivider-Cv06wpGJ.js";import{V as ye,a as Q}from"./filter-DCoQWpqP.js";import{g as $e}from"./departement.servise-Bi755di7.js";import{a as xe}from"./axios-BZ-8xtlA.js";import{g as wt}from"./doctors.servise-DHsi6mbP.js";import{V as ce}from"./VChip-BlyUjdVF.js";import{V as _t,a as ee}from"./VTabs-D4sIb4p7.js";import{V as kt,a as ht}from"./VDataTableVirtual-mGJHolka.js";import{V as Se}from"./VTooltip-DTQ2tPET.js";import"./VAvatar-17awWU_I.js";import"./VList-C2r0kw-4.js";import"./VCheckboxBtn-Dhzr_KXR.js";const Dt=ae({fluid:{type:Boolean,default:!1},...ve(),...Ae(),...ge()},"VContainer"),Ie=le()({name:"VContainer",props:Dt(),setup(t,y){let{slots:s}=y;const{rtlClasses:k}=Te(),{dimensionStyles:c}=Ne(t);return ne(()=>e(t.tag,{class:["v-container",{"v-container--fluid":t.fluid},k.value,t.class],style:[c.value,t.style]},s)),{}}}),Ct=ae({text:String,...ve(),...ge()},"VToolbarTitle"),Be=le()({name:"VToolbarTitle",props:Ct(),setup(t,y){let{slots:s}=y;return ne(()=>{const k=!!(s.default||s.text||t.text);return e(t.tag,{class:["v-toolbar-title",t.class],style:t.style},{default:()=>{var c;return[k&&e("div",{class:"v-toolbar-title__placeholder"},[s.text?s.text():t.text,(c=s.default)==null?void 0:c.call(s)])]}})}),{}}}),St=[null,"prominent","default","comfortable","compact"],Tt=ae({absolute:Boolean,collapse:Boolean,color:String,density:{type:String,default:"default",validator:t=>St.includes(t)},extended:Boolean,extensionHeight:{type:[Number,String],default:48},flat:Boolean,floating:Boolean,height:{type:[Number,String],default:64},image:String,title:String,...He(),...ve(),...Ee(),...Ye(),...ge({tag:"header"}),...je()},"VToolbar"),Pt=le()({name:"VToolbar",props:Tt(),setup(t,y){var v;let{slots:s}=y;const{backgroundColorClasses:k,backgroundColorStyles:c}=Le(Oe(t,"color")),{borderClasses:g}=Ge(t),{elevationClasses:D}=qe(t),{roundedClasses:i}=We(t),{themeClasses:o}=Xe(t),{rtlClasses:x}=Te(),S=Pe(!!(t.extended||(v=s.extension)!=null&&v.call(s))),C=N(()=>parseInt(Number(t.height)+(t.density==="prominent"?Number(t.height):0)-(t.density==="comfortable"?8:0)-(t.density==="compact"?16:0),10)),w=N(()=>S.value?parseInt(Number(t.extensionHeight)+(t.density==="prominent"?Number(t.extensionHeight):0)-(t.density==="comfortable"?4:0)-(t.density==="compact"?8:0),10):0);return Je({VBtn:{variant:"text"}}),ne(()=>{var P;const m=!!(t.title||s.title),n=!!(s.image||t.image),f=(P=s.extension)==null?void 0:P.call(s);return S.value=!!(t.extended||f),e(t.tag,{class:["v-toolbar",{"v-toolbar--absolute":t.absolute,"v-toolbar--collapse":t.collapse,"v-toolbar--flat":t.flat,"v-toolbar--floating":t.floating,[`v-toolbar--density-${t.density}`]:!0},k.value,g.value,D.value,i.value,o.value,x.value,t.class],style:[c.value,t.style]},{default:()=>[n&&e("div",{key:"image",class:"v-toolbar__image"},[s.image?e(de,{key:"image-defaults",disabled:!t.image,defaults:{VImg:{cover:!0,src:t.image}}},s.image):e(xt,{key:"image-img",cover:!0,src:t.image},null)]),e(de,{defaults:{VTabs:{height:K(C.value)}}},{default:()=>{var Y,j,L;return[e("div",{class:"v-toolbar__content",style:{height:K(C.value)}},[s.prepend&&e("div",{class:"v-toolbar__prepend"},[(Y=s.prepend)==null?void 0:Y.call(s)]),m&&e(Be,{key:"title",text:t.title},{text:s.title}),(j=s.default)==null?void 0:j.call(s),s.append&&e("div",{class:"v-toolbar__append"},[(L=s.append)==null?void 0:L.call(s)])])]}}),e(de,{defaults:{VTabs:{height:K(w.value)}}},{default:()=>[e(Ke,null,{default:()=>[S.value&&e("div",{class:"v-toolbar__extension",style:{height:K(w.value)}},[f])]})]})]})}),{contentHeight:C,extensionHeight:w}}}),Ut={class:"info-value"},$t={class:"info-value"},It={class:"info-value"},Bt={class:"info-value"},Ft={class:"info-value"},zt={class:"info-value"},Rt={class:"info-value"},Mt={class:"info-value"},At={class:"info-value"},Nt={class:"info-value"},Ht={class:"info-value"},Et={class:"info-value"},Yt={class:"info-value"},jt={__name:"infoDataDialog",props:{modelValue:Boolean,data:{type:Object,required:!0}},emits:["update:modelValue"],setup(t,{emit:y}){const s=t,k=y,c=V(s.modelValue);$(()=>s.modelValue,i=>c.value=i),$(c,i=>k("update:modelValue",i));function g(i){return i?new Date(i).toLocaleDateString("ru-RU",{year:"numeric",month:"long",day:"numeric"}):"-"}function D(i){return i?new Date(i).toLocaleString("ru-RU",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-"}return(i,o)=>(H(),G(ye,{modelValue:c.value,"onUpdate:modelValue":o[2]||(o[2]=x=>c.value=x),"max-width":"1200",transition:"dialog-bottom-transition"},{default:a(()=>[e(W,null,{default:a(()=>[e(Pt,{flat:"",color:"primary",dark:""},{default:a(()=>[e(Be,{class:"text-h6 font-weight-medium text-white"},{default:a(()=>o[3]||(o[3]=[_(" Детали приёма ")])),_:1}),e(Qe),e(F,{variant:"text",icon:"",onClick:o[0]||(o[0]=x=>c.value=!1)},{default:a(()=>[e(A,{color:"white"},{default:a(()=>o[4]||(o[4]=[_("mdi-close")])),_:1})]),_:1})]),_:1}),e(be,{class:"pa-6"},{default:a(()=>[e(Ie,{fluid:""},{default:a(()=>[e(X,null,{default:a(()=>[e(p,{cols:"12"},{default:a(()=>[o[5]||(o[5]=r("div",{class:"text-subtitle-1 font-weight-medium mb-2"}," Информация о пациенте ",-1)),e(z)]),_:1}),e(p,{cols:"12",sm:"6"},{default:a(()=>[o[6]||(o[6]=r("div",{class:"info-label"}," Ф.И.О: ",-1)),r("div",Ut,h(t.data.patient_fullname),1)]),_:1}),e(p,{cols:"12",sm:"6"},{default:a(()=>[o[7]||(o[7]=r("div",{class:"info-label"}," Дата рождения: ",-1)),r("div",$t,h(g(t.data.birth_date)),1)]),_:1}),e(p,{cols:"12",sm:"6"},{default:a(()=>[o[8]||(o[8]=r("div",{class:"info-label"}," Телефон: ",-1)),r("div",It,h(t.data.phone),1)]),_:1}),e(p,{cols:"12",sm:"6"},{default:a(()=>{var x;return[o[9]||(o[9]=r("div",{class:"info-label"}," Отделение: ",-1)),r("div",Bt,h((x=t.data.department)==null?void 0:x.name),1)]}),_:1}),e(p,{cols:"12",sm:"6"},{default:a(()=>[o[10]||(o[10]=r("div",{class:"info-label"}," Врач: ",-1)),r("div",Ft,h(t.data.doctor_name_text),1)]),_:1}),e(p,{cols:"12",sm:"6"},{default:a(()=>[o[11]||(o[11]=r("div",{class:"info-label"}," Дата приёма: ",-1)),r("div",zt,h(g(t.data.date))+" (Слот №"+h(t.data.slot_no)+") ",1)]),_:1}),e(p,{cols:"12"},{default:a(()=>[o[12]||(o[12]=r("div",{class:"info-label"}," Диагноз: ",-1)),r("div",Rt,h(t.data.diagnosis),1)]),_:1}),e(p,{cols:"12"},{default:a(()=>[o[13]||(o[13]=r("div",{class:"info-label"}," Цель визита: ",-1)),r("div",Mt,h(t.data.purpose),1)]),_:1})]),_:1}),e(z,{class:"my-4"}),e(X,null,{default:a(()=>[e(p,{cols:"12"},{default:a(()=>[o[14]||(o[14]=r("div",{class:"text-subtitle-1 font-weight-medium mb-2"}," Примечания ",-1)),e(z)]),_:1}),e(p,{cols:"12"},{default:a(()=>[o[15]||(o[15]=r("div",{class:"info-label text-red-darken-2"}," Для главного врача: ",-1)),r("div",At,h(t.data.note_for_head),1)]),_:1}),e(p,{cols:"12"},{default:a(()=>[o[16]||(o[16]=r("div",{class:"info-label text-blue-darken-2"}," Заметка для пациента: ",-1)),r("div",Nt,h(t.data.note_public),1)]),_:1})]),_:1}),e(z,{class:"my-4"}),e(X,null,{default:a(()=>[e(p,{cols:"12"},{default:a(()=>[o[17]||(o[17]=r("div",{class:"text-subtitle-1 font-weight-medium mb-2"}," Системная информация ",-1)),e(z)]),_:1}),e(p,{cols:"12",sm:"6"},{default:a(()=>[o[18]||(o[18]=r("div",{class:"info-label"}," Создано: ",-1)),r("div",Ht,h(D(t.data.created_at)),1)]),_:1}),e(p,{cols:"12",sm:"6"},{default:a(()=>[o[19]||(o[19]=r("div",{class:"info-label"}," Обновлено: ",-1)),r("div",Et,h(D(t.data.updated_at)),1)]),_:1}),e(p,{cols:"12"},{default:a(()=>{var x,S,C;return[o[20]||(o[20]=r("div",{class:"info-label"}," Пользователь, создавший запись: ",-1)),r("div",Yt,h(((x=t.data.created_by_user)==null?void 0:x.full_name)||"неизвестно")+" "+h(((C=(S=t.data.created_by_user)==null?void 0:S.user)==null?void 0:C.username)||"неизвестно"),1)]}),_:1})]),_:1})]),_:1})]),_:1}),e(z),e(oe,{class:"pa-4 justify-end"},{default:a(()=>[e(F,{variant:"outlined",color:"primary",onClick:o[1]||(o[1]=x=>c.value=!1)},{default:a(()=>o[21]||(o[21]=[_(" Закрыть ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},Lt=fe(jt,[["__scopeId","data-v-82f578ca"]]),Ot=Ze("appointments",{state:()=>({headers:[{title:"id",align:"start",key:"id"},{title:"Имя пациента",align:"start",key:"patient_fullname"},{title:"Врач",align:"start",key:"doctor.full_name"},{title:"Отделение",align:"start",key:"department.name"},{title:"Дата",align:"start",key:"date"},{title:"Статус",align:"start",key:"status"},{title:"Действия",align:"end",key:"actions",sortable:!1}]}),actions:{}});async function Gt(t){try{const{data:y}=await xe.get("/v1/appointments/get-list",{params:{department_id:t.department_id,for_date:t.for_date,status:t.status}});return y}catch(y){throw console.error("Appointment fetching error:",y),y}}async function qt(t){try{return await xe.post("/v1/appointments/add-appointment",t)}catch(y){return y}}async function Wt(t,y){try{return await xe.put(`/v1/appointments/set-status/${t}?status=${y}`)}catch(s){throw console.error("Statusni yangilashda xatolik:",s),s}}const Xt=ae({autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:t=>!isNaN(parseFloat(t))},maxRows:{type:[Number,String],validator:t=>!isNaN(parseFloat(t))},suffix:String,modelModifiers:Object,...et(),...tt()},"VTextarea"),Jt=le()({name:"VTextarea",directives:{Intersect:at},inheritAttrs:!1,props:Xt(),emits:{"click:control":t=>!0,"mousedown:control":t=>!0,"update:focused":t=>!0,"update:modelValue":t=>!0},setup(t,y){let{attrs:s,emit:k,slots:c}=y;const g=lt(t,"modelValue"),{isFocused:D,focus:i,blur:o}=nt(t),x=N(()=>typeof t.counterValue=="function"?t.counterValue(g.value):(g.value||"").toString().length),S=N(()=>{if(s.maxlength)return s.maxlength;if(!(!t.counter||typeof t.counter!="number"&&typeof t.counter!="string"))return t.counter});function C(b,u){var l,d;!t.autofocus||!b||(d=(l=u[0].target)==null?void 0:l.focus)==null||d.call(l)}const w=V(),v=V(),m=Pe(""),n=V(),f=N(()=>t.persistentPlaceholder||D.value||t.active);function P(){var b;n.value!==document.activeElement&&((b=n.value)==null||b.focus()),D.value||i()}function Y(b){P(),k("click:control",b)}function j(b){k("mousedown:control",b)}function L(b){b.stopPropagation(),P(),re(()=>{g.value="",vt(t["onClick:clear"],b)})}function se(b){var l;const u=b.target;if(g.value=u.value,(l=t.modelModifiers)!=null&&l.trim){const d=[u.selectionStart,u.selectionEnd];re(()=>{u.selectionStart=d[0],u.selectionEnd=d[1]})}}const R=V(),O=V(+t.rows),J=N(()=>["plain","underlined"].includes(t.variant));ot(()=>{t.autoGrow||(O.value=+t.rows)});function T(){t.autoGrow&&re(()=>{if(!R.value||!v.value)return;const b=getComputedStyle(R.value),u=getComputedStyle(v.value.$el),l=parseFloat(b.getPropertyValue("--v-field-padding-top"))+parseFloat(b.getPropertyValue("--v-input-padding-top"))+parseFloat(b.getPropertyValue("--v-field-padding-bottom")),d=R.value.scrollHeight,U=parseFloat(b.lineHeight),E=Math.max(parseFloat(t.rows)*U+l,parseFloat(u.getPropertyValue("--v-input-control-height"))),ie=parseFloat(t.maxRows)*U+l||1/0,M=gt(d??0,E,ie);O.value=Math.floor((M-l)/U),m.value=K(M)})}pe(T),$(g,T),$(()=>t.rows,T),$(()=>t.maxRows,T),$(()=>t.density,T);let I;return $(R,b=>{b?(I=new ResizeObserver(T),I.observe(R.value)):I==null||I.disconnect()}),st(()=>{I==null||I.disconnect()}),ne(()=>{const b=!!(c.counter||t.counter||t.counterValue),u=!!(b||c.details),[l,d]=it(s),{modelValue:U,...E}=De.filterProps(t),ie=dt(t);return e(De,q({ref:w,modelValue:g.value,"onUpdate:modelValue":M=>g.value=M,class:["v-textarea v-text-field",{"v-textarea--prefixed":t.prefix,"v-textarea--suffixed":t.suffix,"v-text-field--prefixed":t.prefix,"v-text-field--suffixed":t.suffix,"v-textarea--auto-grow":t.autoGrow,"v-textarea--no-resize":t.noResize||t.autoGrow,"v-input--plain-underlined":J.value},t.class],style:t.style},l,E,{centerAffix:O.value===1&&!J.value,focused:D.value}),{...c,default:M=>{let{id:Z,isDisabled:we,isDirty:_e,isReadonly:Fe,isValid:ze}=M;return e(ut,q({ref:v,style:{"--v-textarea-control-height":m.value},onClick:Y,onMousedown:j,"onClick:clear":L,"onClick:prependInner":t["onClick:prependInner"],"onClick:appendInner":t["onClick:appendInner"]},ie,{id:Z.value,active:f.value||_e.value,centerAffix:O.value===1&&!J.value,dirty:_e.value||t.dirty,disabled:we.value,focused:D.value,error:ze.value===!1}),{...c,default:Re=>{let{props:{class:ke,...he}}=Re;return e(ue,null,[t.prefix&&e("span",{class:"v-text-field__prefix"},[t.prefix]),Ce(e("textarea",q({ref:n,class:ke,value:g.value,onInput:se,autofocus:t.autofocus,readonly:Fe.value,disabled:we.value,placeholder:t.placeholder,rows:t.rows,name:t.name,onFocus:P,onBlur:o},he,d),null),[[rt("intersect"),{handler:C},null,{once:!0}]]),t.autoGrow&&Ce(e("textarea",{class:[ke,"v-textarea__sizer"],id:`${he.id}-sizer`,"onUpdate:modelValue":Me=>g.value=Me,ref:R,readonly:!0,"aria-hidden":"true"},null),[[mt,g.value]]),t.suffix&&e("span",{class:"v-text-field__suffix"},[t.suffix])])}})},details:u?M=>{var Z;return e(ue,null,[(Z=c.details)==null?void 0:Z.call(c,M),b&&e(ue,null,[e("span",null,null),e(ct,{active:t.persistentCounter||D.value,value:x.value,max:S.value,disabled:t.disabled},c.counter)])])}:void 0})}),ft({},w,v,n)}}),Kt={class:"text-h6 text-white font-weight-bold"},Qt={__name:"addDataDialog",props:{modelValue:Boolean},emits:["update:modelValue","submit"],setup(t,{emit:y}){const s=t,k=y,c=V(s.modelValue);$(()=>s.modelValue,m=>c.value=m),$(c,m=>k("update:modelValue",m)),V(!1),V(!1);const g=V([]),D=V([]),i=me({department_id:null,date:o(),slot_no:null,doctor_id:null,patient_fullname:"",birth_date:null,diagnosis:"",phone:"",purpose:"",doctor_name_text:"",note_for_head:"",note_public:""});function o(){const m=new Date,n=m.getFullYear(),f=String(m.getMonth()+1).padStart(2,"0"),P=String(m.getDate()).padStart(2,"0");return`${n}-${f}-${P}`}function x(){let m=i.phone.replace(/\D/g,"");m.startsWith("7")||(m="7"+m),m.length>11&&(m=m.slice(0,11));const n=[m.slice(1,4),m.slice(4,7),m.slice(7,9),m.slice(9,11)];i.phone=`+7 (${n[0]||""}) ${n[1]||""}${n[2]?"-"+n[2]:""}${n[3]?"-"+n[3]:""}`}async function S(){try{g.value=await wt()}catch(m){console.error("Ошибка при получении списка врачей:",m)}}async function C(){try{D.value=await $e()}catch(m){console.log("Departamentlar yuklanishda xatolik yuz berdi",m)}}function w(){c.value=!1}function v(){const m={...i};k("submit",m),w()}return pe(()=>{S(),C()}),(m,n)=>(H(),G(ye,{modelValue:c.value,"onUpdate:modelValue":n[12]||(n[12]=f=>c.value=f),"max-width":"800",persistent:"",transition:"dialog-bottom-transition"},{default:a(()=>[e(W,{class:"rounded-2xl elevation-6"},{default:a(()=>[e(Ve,{class:"d-flex justify-space-between align-center py-4 px-6 bg-primary rounded-t-2xl"},{default:a(()=>[r("span",Kt,[e(A,null,{default:a(()=>n[13]||(n[13]=[_("mdi-stethoscope")])),_:1}),n[14]||(n[14]=_(" Добавить данные нового приёма "))]),e(F,{icon:"mdi-close",variant:"text",color:"white",onClick:w})]),_:1}),e(be,{class:"py-6 px-6"},{default:a(()=>[e(Ie,null,{default:a(()=>[e(X,{dense:""},{default:a(()=>[e(p,{cols:"12",md:"6"},{default:a(()=>[e(B,{modelValue:i.patient_fullname,"onUpdate:modelValue":n[0]||(n[0]=f=>i.patient_fullname=f),label:"👤 Ф.И.О. пациента",variant:"outlined",density:"comfortable",clearable:"",required:""},null,8,["modelValue"])]),_:1}),e(p,{cols:"12",md:"6"},{default:a(()=>[e(B,{modelValue:i.phone,"onUpdate:modelValue":n[1]||(n[1]=f=>i.phone=f),label:"📞 Номер телефона",type:"tel",variant:"outlined",density:"comfortable",clearable:"",placeholder:"+7 (___) ___-__-__",onInput:x},null,8,["modelValue"])]),_:1}),e(p,{cols:"12",md:"6"},{default:a(()=>[e(B,{modelValue:i.birth_date,"onUpdate:modelValue":n[2]||(n[2]=f=>i.birth_date=f),label:"🎂 Дата рождения",variant:"outlined",density:"comfortable",clearable:"",type:"text","prepend-inner-icon":"mdi-cake-variant"},null,8,["modelValue"])]),_:1}),e(p,{cols:"12",md:"6"},{default:a(()=>[e(B,{modelValue:i.date,"onUpdate:modelValue":n[3]||(n[3]=f=>i.date=f),label:"📅 Дата приёма",variant:"outlined",density:"comfortable",clearable:"",type:"text",placeholder:"YYYY-MM-DD","prepend-inner-icon":"mdi-calendar"},null,8,["modelValue"])]),_:1}),e(p,{cols:"12",md:"6"},{default:a(()=>[e(B,{modelValue:i.doctor_name_text,"onUpdate:modelValue":n[4]||(n[4]=f=>i.doctor_name_text=f),label:"👨‍⚕️ Врач (текст)",variant:"outlined",density:"comfortable"},null,8,["modelValue"])]),_:1}),e(p,{cols:"12",md:"6"},{default:a(()=>[e(B,{modelValue:i.diagnosis,"onUpdate:modelValue":n[5]||(n[5]=f=>i.diagnosis=f),label:"🧠 Диагноз",variant:"outlined",density:"comfortable"},null,8,["modelValue"])]),_:1}),e(p,{cols:"12",md:"6"},{default:a(()=>[e(B,{modelValue:i.purpose,"onUpdate:modelValue":n[6]||(n[6]=f=>i.purpose=f),label:"🎯 Цель приёма",variant:"outlined",density:"comfortable"},null,8,["modelValue"])]),_:1}),e(p,{cols:"12",md:"6"},{default:a(()=>[e(B,{modelValue:i.note_public,"onUpdate:modelValue":n[7]||(n[7]=f=>i.note_public=f),label:"📝 Общий комментарий",variant:"outlined",density:"comfortable"},null,8,["modelValue"])]),_:1}),e(p,{cols:"12"},{default:a(()=>[e(Jt,{modelValue:i.note_for_head,"onUpdate:modelValue":n[8]||(n[8]=f=>i.note_for_head=f),label:"📋 Комментарий для руководителя",variant:"outlined","auto-grow":"",rows:"2",clearable:""},null,8,["modelValue"])]),_:1}),e(p,{cols:"12",md:"4"},{default:a(()=>[e(Q,{modelValue:i.department_id,"onUpdate:modelValue":n[9]||(n[9]=f=>i.department_id=f),items:D.value,"item-title":"name","item-value":"id",label:"🏢 Отделение",variant:"outlined",density:"comfortable",clearable:"","prepend-inner-icon":"mdi-office-building"},null,8,["modelValue","items"])]),_:1}),e(p,{cols:"12",md:"4"},{default:a(()=>[e(Q,{modelValue:i.doctor_id,"onUpdate:modelValue":n[10]||(n[10]=f=>i.doctor_id=f),items:g.value,"item-title":"full_name","item-value":"id",label:"👨‍⚕️ Врач",variant:"outlined",density:"comfortable",clearable:"","prepend-inner-icon":"mdi-stethoscope"},null,8,["modelValue","items"])]),_:1}),e(p,{cols:"12",md:"4"},{default:a(()=>[e(B,{modelValue:i.slot_no,"onUpdate:modelValue":n[11]||(n[11]=f=>i.slot_no=f),modelModifiers:{number:!0},label:"⏰ Номер слота",type:"number",variant:"outlined",density:"comfortable"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(oe,{class:"px-6 pb-6 d-flex justify-end"},{default:a(()=>[e(F,{variant:"tonal",color:"grey",class:"mr-3",onClick:w},{default:a(()=>n[15]||(n[15]=[_(" Отмена ")])),_:1}),e(F,{color:"primary",class:"px-6","prepend-icon":"mdi-content-save",onClick:v},{default:a(()=>n[16]||(n[16]=[_(" Сохранить ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},Zt=fe(Qt,[["__scopeId","data-v-5c3b1c94"]]),ea={class:"mb-3"},ta={class:"mt-2"},aa={key:0,class:"mt-4 text-center"},la={__name:"changeStatus",props:{modelValue:Boolean,currentTab:String,item:Object},emits:["update:modelValue","update-status"],setup(t,{emit:y}){const s=t,k=y,c=N({get:()=>s.modelValue,set:w=>k("update:modelValue",w)}),g=V(null),D=N(()=>({planned:[{label:"Допущен",value:"admitted"},{label:"Отменён",value:"canceled"}],admitted:[{label:"Госпитализирован",value:"hospitalized"},{label:"Отменён",value:"canceled"}],hospitalized:[{label:"Отменён",value:"canceled"}],canceled:[{label:"Планируется",value:"planned"}]})[s.currentTab]||[]),i=()=>{g.value&&(k("update-status",{id:s.item.id,status:g.value}),o())},o=()=>{k("update:modelValue",!1),g.value=null};function x(w){switch(w){case"planned":return"blue";case"admitted":return"green";case"hospitalized":return"deep-purple";case"canceled":return"red";default:return"grey"}}function S(w){switch(w){case"planned":return"mdi-calendar-clock";case"admitted":return"mdi-check-circle";case"hospitalized":return"mdi-hospital-building";case"canceled":return"mdi-cancel";default:return"mdi-help-circle"}}function C(w){switch(w){case"planned":return"Планируется";case"admitted":return"Допущен";case"hospitalized":return"Госпитализирован";case"canceled":return"Отменён";default:return"Неизвестно"}}return(w,v)=>(H(),G(ye,{modelValue:c.value,"onUpdate:modelValue":v[1]||(v[1]=m=>c.value=m),"max-width":"450",transition:"dialog-bottom-transition",persistent:""},{default:a(()=>[e(W,{class:"pa-3 rounded-xl elevation-3"},{default:a(()=>[e(Ve,{class:"d-flex align-center mb-1"},{default:a(()=>[e(A,{color:"primary",size:"28",class:"mr-2"},{default:a(()=>v[2]||(v[2]=[_("mdi-autorenew")])),_:1}),v[3]||(v[3]=r("span",{class:"text-h6 font-weight-bold"},"Изменить статус",-1))]),_:1}),e(z,{class:"my-2"}),e(be,null,{default:a(()=>[r("div",ea,[v[4]||(v[4]=r("span",{class:"text-subtitle-2 text-medium-emphasis"},"Текущий статус:",-1)),r("div",ta,[e(ce,{color:x(t.item.status),class:"font-weight-medium","text-color":"white",size:"small"},{default:a(()=>[e(A,{start:"",small:""},{default:a(()=>[_(h(S(t.item.status)),1)]),_:1}),_(" "+h(C(t.item.status)),1)]),_:1},8,["color"])])]),e(Q,{modelValue:g.value,"onUpdate:modelValue":v[0]||(v[0]=m=>g.value=m),items:D.value,"item-title":"label","item-value":"value",label:"Выберите новый статус",density:"comfortable",variant:"outlined",clearable:"",class:"rounded-lg","prepend-inner-icon":"mdi-flag-outline"},null,8,["modelValue","items"]),g.value?(H(),Ue("div",aa,[v[5]||(v[5]=r("span",{class:"text-body-2 mb-2 d-block"},"Выбранный статус:",-1)),e(ce,{color:x(g.value),size:"large","text-color":"white",class:"font-weight-bold px-4"},{default:a(()=>[e(A,{start:"",small:""},{default:a(()=>[_(h(S(g.value)),1)]),_:1}),_(" "+h(C(g.value)),1)]),_:1},8,["color"])])):te("",!0)]),_:1}),e(z,{class:"my-2"}),e(oe,{class:"justify-end"},{default:a(()=>[e(F,{variant:"text",color:"error",onClick:o},{default:a(()=>[e(A,{start:"",small:""},{default:a(()=>v[6]||(v[6]=[_("mdi-close-circle")])),_:1}),v[7]||(v[7]=_(" Отмена "))]),_:1}),e(F,{color:"primary",class:"px-4",disabled:!g.value,onClick:i},{default:a(()=>[e(A,{start:"",small:""},{default:a(()=>v[8]||(v[8]=[_("mdi-check-circle")])),_:1}),v[9]||(v[9]=_(" Сохранить "))]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},na=fe(la,[["__scopeId","data-v-b0add185"]]),oa={class:"ma-2",flat:""},sa={class:"d-flex"},ha={__name:"index",setup(t){const y=Ot(),s=pt(),k=V(!1),c=V(null),g=V(null),D=V(!1),i=V("planned"),o=V(!1),x=me({page:1,itemsPerPage:10}),S=V(0),C=V(!1),w=V(null),v=V([]),m=V([]),n=me({department_id:null,for_date:null,status:i.value}),f=V(!1),P=V([]);function Y(u){switch(u){case"planned":return"blue";case"admitted":return"green";case"hospitalized":return"deep-purple";case"canceled":return"red";default:return"grey"}}function j(u){switch(u){case"planned":return"mdi-calendar-clock";case"admitted":return"mdi-check-circle";case"hospitalized":return"mdi-hospital-building";case"canceled":return"mdi-cancel";default:return"mdi-help-circle"}}function L(u){switch(u){case"planned":return"Планируется";case"admitted":return"Допущен";case"hospitalized":return"Госпитализирован";case"canceled":return"Отменено";default:return"Неизвестно"}}const se=u=>{if(!u)return;const l=new Date(u),d=l.getFullYear(),U=String(l.getMonth()+1).padStart(2,"0"),E=String(l.getDate()).padStart(2,"0");c.value=`${d}-${U}-${E}`,n.for_date=c.value,k.value=!1},R=u=>{w.value=u,o.value=!0},O=u=>{m.value=u,C.value=!0},J=async()=>{try{P.value=await $e(),P.value.length>0&&(n.department_id=P.value[0].id),await T()}catch(u){console.error("Ошибка при загрузке департаментов:",u),s.error("Ошибка при загрузке департаментов: ❌")}},T=async()=>{f.value=!0;const u={department_id:n.department_id,for_date:n.for_date,status:n.status};try{v.value=await Gt(u)}catch(l){console.error("Data loading error",l)}finally{f.value=!1}},I=async u=>{try{await qt(u),s.success("Приём успешно добавлен ✅"),await T()}catch(l){console.error("Ошибка при добавлении приёма:",l),s.error("Ошибка при сохранении ❌")}},b=async({id:u,status:l})=>{try{await Wt(u,l),await T(),s.success("Status muvaffaqiyatli yangilandi ✅")}catch(d){console.error("Ошибка при обновлении статуса:",d),s.error("Ошибка при обновлении статуса ❌")}};return pe(()=>{J()}),$(i,async u=>{n.status=u,await T()}),$(()=>n.department_id,(u,l)=>{u!==l&&T()}),$(()=>n.for_date,(u,l)=>{u!==l&&T()}),(u,l)=>(H(),Ue("div",null,[r("div",oa,[e(W,{class:"mb-2 text-xl"},{default:a(()=>[e(_t,{modelValue:i.value,"onUpdate:modelValue":l[0]||(l[0]=d=>i.value=d),color:"primary",grow:""},{default:a(()=>[e(ee,{value:"planned"},{default:a(()=>l[11]||(l[11]=[_(" Планируется ")])),_:1}),e(ee,{value:"admitted"},{default:a(()=>l[12]||(l[12]=[_(" Допущенный ")])),_:1}),e(ee,{value:"hospitalized"},{default:a(()=>l[13]||(l[13]=[_(" Госпитализирован ")])),_:1}),e(ee,{value:"canceled"},{default:a(()=>l[14]||(l[14]=[_(" Отменено ")])),_:1})]),_:1},8,["modelValue"])]),_:1}),e(W,{class:"mb-3 py-1",flat:""},{default:a(()=>[e(X,{class:"pa-2 align-center"},{default:a(()=>[e(Ve,{class:"mr-4"},{default:a(()=>l[15]||(l[15]=[r("span",null,"📊 Общая информация",-1)])),_:1}),e(p,{cols:"12",md:"3"},{default:a(()=>[e(Q,{modelValue:n.department_id,"onUpdate:modelValue":l[1]||(l[1]=d=>n.department_id=d),label:"Departament",items:P.value,"item-title":"name","item-value":"id",clearable:""},null,8,["modelValue","items"])]),_:1}),e(p,{cols:"12",md:"3"},{default:a(()=>[e(bt,{modelValue:k.value,"onUpdate:modelValue":l[4]||(l[4]=d=>k.value=d),"close-on-content-click":!1,transition:"scale-transition","offset-y":"","min-width":"auto"},{activator:a(({props:d})=>[e(B,q({modelValue:c.value,"onUpdate:modelValue":l[2]||(l[2]=U=>c.value=U),label:"Дата (YYYY-MM-DD)"},d,{"prepend-inner-icon":"mdi-calendar",placeholder:"2025-10-14",clearable:""}),null,16,["modelValue"])]),default:a(()=>[e(Vt,{modelValue:g.value,"onUpdate:modelValue":[l[3]||(l[3]=d=>g.value=d),se],color:"primary"},null,8,["modelValue"])]),_:1},8,["modelValue"])]),_:1}),e(p,{cols:"12",md:"3",class:"d-flex justify-end"},{default:a(()=>[e(F,{color:"primary",onClick:l[5]||(l[5]=d=>D.value=!0)},{default:a(()=>l[16]||(l[16]=[_(" Добавить информацию ")])),_:1})]),_:1})]),_:1})]),_:1}),e(X,{dense:""},{default:a(()=>[e(p,{cols:"12"},{default:a(()=>[e(W,{flat:""},{default:a(()=>[e(z),e(kt,{headers:yt(y).headers,items:v.value,loading:f.value,height:"70vh","loading-text":"Загрузка...","no-data-text":"Данные не найдены"},{"item.status":a(({item:d})=>[e(ce,{color:Y(d.status),"text-color":"white",size:"small",class:"font-weight-medium"},{default:a(()=>[e(A,{start:"",small:""},{default:a(()=>[_(h(j(d.status)),1)]),_:2},1024),_(" "+h(L(d.status)),1)]),_:2},1032,["color"])]),"item.actions":a(({item:d})=>[r("div",sa,[e(Se,{text:"Просмотр",location:"top"},{activator:a(({props:U})=>[e(F,q(U,{icon:"mdi-eye-outline",variant:"plain",color:"info",onClick:E=>O(d)}),null,16,["onClick"])]),_:2},1024),e(Se,{text:"Изменить статус",location:"top"},{activator:a(({props:U})=>[e(F,q(U,{icon:"mdi-atom-variant",variant:"plain",color:"warning",onClick:E=>R(d)}),null,16,["onClick"])]),_:2},1024)])]),_:1},8,["headers","items","loading"]),e(oe,{class:"w-full d-flex justify-space-between mt-2"},{default:a(()=>[e(Q,{modelValue:x.itemsPerPage,"onUpdate:modelValue":[l[6]||(l[6]=d=>x.itemsPerPage=d),T],items:[10,20,50],label:"Каждая страница","max-width":"150"},null,8,["modelValue"]),e(ht,{modelValue:x.page,"onUpdate:modelValue":[l[7]||(l[7]=d=>x.page=d),T],length:Math.ceil(S.value/x.itemsPerPage),"total-visible":4,rounded:"circle"},null,8,["modelValue","length"])]),_:1})]),_:1})]),_:1})]),_:1})]),C.value?(H(),G(Lt,{key:0,modelValue:C.value,"onUpdate:modelValue":l[8]||(l[8]=d=>C.value=d),data:m.value},null,8,["modelValue","data"])):te("",!0),D.value?(H(),G(Zt,{key:1,modelValue:D.value,"onUpdate:modelValue":l[9]||(l[9]=d=>D.value=d),departament:P.value,onSubmit:I},null,8,["modelValue","departament"])):te("",!0),o.value?(H(),G(na,{key:2,modelValue:o.value,"onUpdate:modelValue":l[10]||(l[10]=d=>o.value=d),item:w.value,"current-tab":i.value,onUpdateStatus:b},null,8,["modelValue","item","current-tab"])):te("",!0)]))}};export{ha as default};
