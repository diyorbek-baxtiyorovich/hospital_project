import{aq as y,ar as k,r as x,w as g,D as P,f as b,e as i,o as v,b as e,s as w,H as C,as as L,m as o,d as T,t as Y,j as A,at as D}from"./index-DvA8P6Gk.js";import{g as S}from"./agents.servise-CPjzNILr.js";import{V as F,b as M,d as z,c as B}from"./VCard-DAsvdsxx.js";import{a as u,V as U}from"./VRow-CXlrfULG.js";import{V as H,a as I}from"./VDataTableVirtual-DKZT2oRp.js";import{V as N}from"./filter-B20m9EDS.js";import"./axios-B6xj8bPG.js";import"./VAvatar-B_KDJW1g.js";import"./VImg-C2yDnbiZ.js";import"./VChip-BB7pSCHc.js";import"./VDivider-zS_1rsPv.js";import"./VList-_OenMqFZ.js";const $=y("agent",{state:()=>({headers:[{title:"Id",align:"start",key:"agent_id",sortable:!1},{title:"Agent F.I.SH",align:"start",key:"full_name"},{title:"Kechiktirilgan daromad",align:"start",key:"overdue_income"},{title:"Foiz daromadi",align:"start",key:"percentage_income"},{title:"Jarima daromadi",align:"start",key:"surcharge_income"},{title:"Umumiy daromad",align:"start",key:"total_income"}],pageParams:{page:1,size:50,for_month:null},pageLength:1,agentList:[],loading:!1}),actions:{async fetchAgentsList(){this.loading=!0;try{const t=await S(this.pageParams);this.pageLength=(t==null?void 0:t.pages)||1,this.agentList=t==null?void 0:t.items}catch(t){return t}finally{this.loading=!1}}}}),j=["onClick"],ta={__name:"index",setup(t){const p=A();k();const a=$(),c=/^(19|20)\d{2}-(0[1-9]|1[0-2])$/,m=x(a.pageParams.for_month||"");function f(r){return c.test(r)||"Format YYYY-MM bo‘lishi kerak (masalan: 2025-09)"}async function n(){await a.fetchAgentsList()}function h(){a.pageParams.page=1,n()}async function V(r){await p.push(`/agents/${r}`)}let d=null;return g(m,r=>{a.pageParams.for_month=r}),g(()=>a.pageParams.for_month,()=>{clearTimeout(d),d=setTimeout(()=>{a.pageParams.page=1,n()},600)}),P(()=>{n()}),(r,l)=>{const _=D("mask");return v(),b(F,null,{default:i(()=>[e(U,{class:"ma-2",align:"center"},{default:i(()=>[e(u,{cols:"12",md:"6"},{default:i(()=>[e(M,{class:"d-flex align-center pe-2"},{default:i(()=>l[3]||(l[3]=[w(" Agentlar to‘plagan daromadlari ")])),_:1})]),_:1}),e(u,{cols:"12",md:"3"},{default:i(()=>[C(e(L,{modelValue:m.value,"onUpdate:modelValue":l[0]||(l[0]=s=>m.value=s),label:"Yil va oyni kiriting (YYYY-MM)",rules:[f],clearable:""},null,8,["modelValue","rules"]),[[_,"####-##"]])]),_:1})]),_:1}),e(B,null,{default:i(()=>[e(H,{headers:o(a).headers,items:o(a).agentList,loading:o(a).loading,"fixed-header":"",height:"65vh","hide-default-footer":"","loading-text":"ma'lumotlar yuklanmoqda","no-data-text":"ma'lumot topilmadi"},{"item.full_name":i(({item:s})=>[T("span",{class:"text-primary cursor-pointer",onClick:q=>V(s.agent_id)},Y(s.full_name),9,j)]),_:1},8,["headers","items","loading"]),e(z,{class:"w-full d-flex justify-space-between mt-2"},{default:i(()=>[e(N,{modelValue:o(a).pageParams.size,"onUpdate:modelValue":[l[1]||(l[1]=s=>o(a).pageParams.size=s),h],items:[10,20,50],label:"Har bir sahifa","max-width":"150"},null,8,["modelValue"]),e(I,{modelValue:o(a).pageParams.page,"onUpdate:modelValue":[l[2]||(l[2]=s=>o(a).pageParams.page=s),n],length:o(a).pageLength,"total-visible":4,rounded:"circle"},null,8,["modelValue","length"])]),_:1})]),_:1})]),_:1})}}};export{ta as default};
