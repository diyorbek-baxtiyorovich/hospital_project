import{aD as M,aE as U,r as u,o as z,c as S,b as e,e as a,s as d,a3 as g,a2 as T,aF as b,w as I,D as N,F as E,m as L,t as O,d as X,V as A}from"./index-BUWpNgCh.js";import{a as R,u as G,g as H,d as J}from"./departmentService-6_KXkQz_.js";import{V as k,b as x,d as h}from"./VCard-BAYbD_fM.js";import{V as $}from"./VDivider-E9DHGbd1.js";import{V as j}from"./VForm-DC1LXLNq.js";import{V as _,a as y}from"./VRow-DTE0XFEN.js";import{V as B}from"./VDialog-TVbLP3yi.js";import{V as K}from"./VDataTableVirtual-fe1D3rEJ.js";import"./axios-BAixJXzr.js";import"./VAvatar-B6xxjCX8.js";import"./VImg-CfyBjxYh.js";import"./filter-DKa52c3h.js";import"./VList-CeZzF82H.js";import"./VChip-BggzV1kk.js";const P=M("department",{state:()=>({headers:[{title:"â„–",align:"start",key:"id",sortable:!1},{title:"Departament nomi",align:"start",key:"department_name"},{title:"Sozlamalar",align:"end",key:"actions",sortable:!1}]}),actions:{}}),Q={class:"text-center"},W={__name:"CreateDepartment",emits:["created"],setup(w,{emit:D}){const c=D,p=U(),V=u({department_name:null}),i=u(!1),n=u(null);async function m(){const{valid:r}=await n.value.validate();if(!r)return;(await R(V.value)).status===201?(p.success("Muvofaqqiyatli yaratildi."),c("created"),n.value.reset(),i.value=!1):p.error("Xatolik yuz berdi!")}return(r,l)=>(z(),S("div",Q,[e(g,{class:"ml-3",onClick:l[0]||(l[0]=t=>i.value=!0)},{default:a(()=>l[4]||(l[4]=[d(" qo'shish ")])),_:1}),e(B,{modelValue:i.value,"onUpdate:modelValue":l[3]||(l[3]=t=>i.value=t),"max-width":"600"},{default:a(()=>[e(k,{class:"pa-4"},{default:a(()=>[e(x,null,{default:a(()=>l[5]||(l[5]=[d(" Departament yaratish ")])),_:1}),e($,{class:"mb-4"}),e(j,{ref_key:"form",ref:n,onSubmit:T(m,["prevent"])},{default:a(()=>[e(_,null,{default:a(()=>[e(y,{cols:"12",md:"12"},{default:a(()=>[e(b,{modelValue:V.value.department_name,"onUpdate:modelValue":l[1]||(l[1]=t=>V.value.department_name=t),rules:[t=>!!t||"to'ldirish majburiy!",t=>t&&t.length>=3||"kamida 3 harfdan iborat bo'lishi zarur"],label:"Departament nomi",required:""},null,8,["modelValue","rules"])]),_:1})]),_:1}),e(h,{class:"d-flex w-full justify-end mt-4"},{default:a(()=>[e(g,{color:"error",variant:"elevated",onClick:l[2]||(l[2]=t=>i.value=!1)},{default:a(()=>l[6]||(l[6]=[d(" bekor qilish ")])),_:1}),e(g,{color:"success",type:"submit",variant:"elevated"},{default:a(()=>l[7]||(l[7]=[d(" saqlash ")])),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1},8,["modelValue"])]))}},Y={class:"text-center"},Z={__name:"UpdateDepartment",props:{updatingItem:Object,updateDialog:{type:Boolean,default:!1}},emits:["updated","update:updateDialog"],setup(w,{emit:D}){const c=w,p=D;function V(){p("update:updateDialog",!1)}const i=U(),n=u(),m=u(null);async function r(){const{valid:l}=await m.value.validate();if(!l)return;const t=await G(c.updatingItem.id,n.value);(t==null?void 0:t.status)===200?(i.success("Muvofaqqiyatli yaratildi."),p("update:updateDialog",!1),p("updated"),m.value.reset()):i.error("Xatolik yuz berdi")}return I(()=>c.updateDialog,l=>{n.value={...c.updatingItem}}),(l,t)=>(z(),S("div",Y,[e(B,{modelValue:c.updateDialog,"onUpdate:modelValue":t[1]||(t[1]=v=>c.updateDialog=v),"max-width":"600"},{default:a(()=>[e(k,{class:"pa-4"},{default:a(()=>[e(x,null,{default:a(()=>t[2]||(t[2]=[d(" O'zgartirish ")])),_:1}),e($,{class:"mb-4"}),e(j,{ref_key:"form",ref:m,onSubmit:T(r,["prevent"])},{default:a(()=>[e(_,null,{default:a(()=>[e(y,{cols:"12",md:"12"},{default:a(()=>[e(b,{modelValue:n.value.department_name,"onUpdate:modelValue":t[0]||(t[0]=v=>n.value.department_name=v),rules:[v=>!!v||"to'ldirish majburiy!",v=>v&&v.length>=3||"kamida 3 harfdan iborat bo'lishi zarur"],label:"Departament nomi",required:""},null,8,["modelValue","rules"])]),_:1})]),_:1}),e(h,{class:"d-flex w-full justify-end mt-4"},{default:a(()=>[e(g,{color:"error",variant:"elevated",onClick:V},{default:a(()=>t[3]||(t[3]=[d(" bekor qilish ")])),_:1}),e(g,{color:"success",type:"submit",variant:"elevated"},{default:a(()=>t[4]||(t[4]=[d(" saqlash ")])),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1},8,["modelValue"])]))}},ve={__name:"index",setup(w){const D=U(),c=P(),p=u(!1),V=u([]),i=u(null);async function n(){p.value=!0;const f=await H();p.value=!1,f!=null&&f.length&&(V.value=f)}const m=u(!1),r=u(null),l=u(!1);function t(f){r.value=f,m.value=!0}async function v(){l.value=!0;const f=await J(r.value.id);l.value=!1,f.status===200&&D.success("Muvofaqqiyatli o'chirildi"),m.value=!1,await n()}const C=u(!1);function F(f){r.value=null,r.value=f,C.value=!0}return N(()=>{n()}),(f,s)=>(z(),S(E,null,[e(Z,{"update-dialog":C.value,"onUpdate:updateDialog":s[0]||(s[0]=o=>C.value=o),"updating-item":r.value,onUpdated:n},null,8,["update-dialog","updating-item"]),e(k,{flat:""},{default:a(()=>[e(_,{class:"ma-2"},{default:a(()=>[e(y,{cols:"12",md:"6"},{default:a(()=>[e(x,{class:"d-flex align-center pe-2"},{default:a(()=>s[6]||(s[6]=[d(" Departamentlar ro'yxati ")])),_:1})]),_:1}),e(y,{class:"d-flex",cols:"12",md:"6"},{default:a(()=>[e(b,{modelValue:i.value,"onUpdate:modelValue":s[1]||(s[1]=o=>i.value=o),density:"compact","hide-details":"",label:"qidirish...","prepend-inner-icon":"mdi-magnify"},null,8,["modelValue"]),e(W,{onCreated:n})]),_:1})]),_:1}),e($),e(K,{search:i.value,"onUpdate:search":s[2]||(s[2]=o=>i.value=o),"filter-keys":["department_name"],headers:L(c).headers,items:V.value,loading:p.value,"fixed-header":"",height:"71vh","loading-text":"ma'lumotlar yuklanmoqda","no-data-text":"ma'lumot topilmadi"},{"item.id":a(({item:o,index:q})=>[d(O(q+1),1)]),"item.actions":a(({item:o})=>[X("div",null,[e(g,{color:"warning",density:"default",icon:"mdi-pencil-circle",size:"x-large",variant:"plain",onClick:q=>F(o)},null,8,["onClick"]),e(g,{color:"error",density:"default",icon:"mdi-delete",size:"x-large",variant:"plain",onClick:q=>t(o)},null,8,["onClick"])])]),_:1},8,["search","headers","items","loading"]),e(B,{modelValue:m.value,"onUpdate:modelValue":s[5]||(s[5]=o=>m.value=o),"max-width":"600",persistent:""},{default:a(()=>[e(k,{class:"pa-4"},{actions:a(()=>[e(A),e(g,{color:"success",onClick:s[4]||(s[4]=o=>m.value=!1)},{default:a(()=>s[8]||(s[8]=[d(" Bekor qilish ")])),_:1}),e(g,{loading:l.value,color:"error",onClick:v},{default:a(()=>s[9]||(s[9]=[d(" Tasdiqlash ")])),_:1},8,["loading"])]),default:a(()=>[e(x,{class:"text-center mb-4 font-weight-bold"},{default:a(()=>s[7]||(s[7]=[d(" Ushbu ma'lumotni o'chirishni tasdiqlaysizmi? ")])),_:1}),e(_,{class:"mb-4"},{default:a(()=>[e(y,{cols:"12",md:"12"},{default:a(()=>[e(b,{modelValue:r.value.name,"onUpdate:modelValue":s[3]||(s[3]=o=>r.value.name=o),label:"Departament nomi",readonly:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})],64))}};export{ve as default};
