import{aq as J,ar as j,r as f,at as B,o as L,c as F,b as e,e as i,s as v,a3 as k,a2 as $,as as r,H as U,w as R,D as O,F as X,m as E,t as H,d as K,V as Y}from"./index-BJ8pfeHM.js";import{a as G,g as P,u as Q,b as W,d as Z}from"./localCodeService-f11bn_k0.js";import{g as ll}from"./regionService-BZ1bIvba.js";import"./axios-Bk3NF34q.js";import{V as x,b as w,d as S}from"./VCard-BJ5v55a9.js";import{V as N}from"./VDivider-COlW_c1X.js";import{V as T}from"./VForm-DDR1PA-O.js";import{V as z,a as d}from"./VRow-BjUXeRPy.js";import{V as I}from"./VAutocomplete-DO_jcab7.js";import{V as M}from"./VDialog-DeXd6Mc4.js";import{V as el}from"./VDataTableVirtual-QzxIzDHV.js";import"./VAvatar-CFkVQRPI.js";import"./VImg-Xcp6Wsn5.js";import"./filter-Dr9EnPAf.js";import"./VList-CcefFS0P.js";import"./VChip-HyBkADBT.js";const al=J("localCode",{state:()=>({headers:[{title:"â„–",align:"start",key:"id",sortable:!1},{title:"Kod",align:"start",key:"code"},{title:"Nomi",align:"start",key:"name"},{title:"Manzil",align:"start",key:"address"},{title:"Sozlamalar",align:"end",key:"actions",sortable:!1}]}),actions:{}}),il={class:"text-center"},tl={__name:"CreateLocalCode",props:{regionList:Array},emits:["created"],setup(c,{emit:h}){const V=h,b=j(),u=f({code:null,name:null,region_id:null,head:null,index:null,address:null,location_latt:null,location_long:null,inn:null,phone_number:null,manager:null,status:!0}),p=f(!1),o=f(null);async function q(){const{valid:y}=await o.value.validate();if(!y)return;const t=await G(u.value);(t==null?void 0:t.status)===201?(b.success("Muvofaqqiyatli yaratildi."),V("created"),o.value.reset(),p.value=!1):b.error("Xatolik yuz berdi!")}return(y,t)=>{const s=B("mask");return L(),F("div",il,[e(k,{class:"ml-3",onClick:t[0]||(t[0]=l=>p.value=!0)},{default:i(()=>t[13]||(t[13]=[v(" qo'shish ")])),_:1}),e(M,{modelValue:p.value,"onUpdate:modelValue":t[12]||(t[12]=l=>p.value=l),"max-width":"800"},{default:i(()=>[e(x,{class:"pa-4"},{default:i(()=>[e(w,null,{default:i(()=>t[14]||(t[14]=[v(" Yangi filial yaratish ")])),_:1}),e(N,{class:"mb-4"}),e(T,{ref_key:"form",ref:o,onSubmit:$(q,["prevent"])},{default:i(()=>[e(z,null,{default:i(()=>[e(d,{cols:"12",md:"6"},{default:i(()=>[e(r,{modelValue:u.value.code,"onUpdate:modelValue":t[1]||(t[1]=l=>u.value.code=l),rules:[l=>!!l||"to'ldirish majburiy!",l=>l&&l.length>=3||"kamida 3 raqamdan iborat bo'lishi zarur"],label:"Lokal kod",required:""},null,8,["modelValue","rules"])]),_:1}),e(d,{cols:"12",md:"6"},{default:i(()=>[e(r,{modelValue:u.value.name,"onUpdate:modelValue":t[2]||(t[2]=l=>u.value.name=l),rules:[l=>!!l||"to'ldirish majburiy!",l=>l&&l.length>=3||"kamida 3 harfdan iborat bo'lishi zarur"],label:"Filial nomi",required:""},null,8,["modelValue","rules"])]),_:1}),e(d,{cols:"12",md:"6"},{default:i(()=>[e(r,{modelValue:u.value.address,"onUpdate:modelValue":t[3]||(t[3]=l=>u.value.address=l),rules:[l=>!!l||"to'ldirish majburiy!",l=>l&&l.length>=3||" kamida 3 harfdan iborat bo'lishi zarur"],label:"Filial manzili",required:""},null,8,["modelValue","rules"])]),_:1}),e(d,{cols:"12",md:"6"},{default:i(()=>[e(I,{modelValue:u.value.region_id,"onUpdate:modelValue":t[4]||(t[4]=l=>u.value.region_id=l),items:c.regionList,rules:[l=>!!l||"to'ldirish majburiy!"],clearable:"","item-title":"name_uz","item-value":"id",label:"Viloyat",required:""},null,8,["modelValue","items","rules"])]),_:1}),e(d,{cols:"12",md:"6"},{default:i(()=>[e(r,{modelValue:u.value.location_long,"onUpdate:modelValue":t[5]||(t[5]=l=>u.value.location_long=l),rules:[l=>!!l||"to'ldirish majburiy!",l=>l&&l.length>=3||""],hint:"Masalan: 41.2995 (navigator orqali olish mumkin)",label:"Joylashuv uzunligi","persistent-hint":"",required:""},null,8,["modelValue","rules"])]),_:1}),e(d,{cols:"12",md:"6"},{default:i(()=>[e(r,{modelValue:u.value.location_latt,"onUpdate:modelValue":t[6]||(t[6]=l=>u.value.location_latt=l),rules:[l=>!!l||"to'ldirish majburiy!",l=>l&&l.length>=3||""],hint:"Masalan: 69.2401 (navigator orqali olish mumkin)",label:"Joylashuv kengligi","persistent-hint":"",required:""},null,8,["modelValue","rules"])]),_:1}),e(d,{cols:"12",md:"6"},{default:i(()=>[e(r,{modelValue:u.value.index,"onUpdate:modelValue":t[7]||(t[7]=l=>u.value.index=l),rules:[l=>!!l||"to'ldirish majburiy!",l=>l&&l.length>=3||" kamida 3 harfdan iborat bo'lishi zarur"],label:"Filial indeksi",required:""},null,8,["modelValue","rules"])]),_:1}),e(d,{cols:"12",md:"6"},{default:i(()=>[U(e(r,{modelValue:u.value.phone_number,"onUpdate:modelValue":t[8]||(t[8]=l=>u.value.phone_number=l),rules:[l=>!!l||"to'ldirish majburiy!",l=>l&&l.length>=14||"Telefon raqamni to'g'ri kiriting"],label:"Filial telefon raqami",required:""},null,8,["modelValue","rules"]),[[s,"(##) ###-##-##"]])]),_:1}),e(d,{cols:"12",md:"6"},{default:i(()=>[U(e(r,{modelValue:u.value.inn,"onUpdate:modelValue":t[9]||(t[9]=l=>u.value.inn=l),rules:[l=>!!l||"to'ldirish majburiy!",l=>l&&l.length>=9||"INN raqamini to'g'ri kiriting"],label:"Filial INN raqami",required:""},null,8,["modelValue","rules"]),[[s,"#########"]])]),_:1}),e(d,{cols:"12",md:"6"},{default:i(()=>[e(r,{modelValue:u.value.manager,"onUpdate:modelValue":t[10]||(t[10]=l=>u.value.manager=l),label:"Filial boshqaruvchisi",required:""},null,8,["modelValue"])]),_:1})]),_:1}),e(S,{class:"d-flex w-full justify-end mt-4"},{default:i(()=>[e(k,{color:"error",variant:"elevated",onClick:t[11]||(t[11]=l=>p.value=!1)},{default:i(()=>t[15]||(t[15]=[v(" bekor qilish ")])),_:1}),e(k,{color:"success",type:"submit",variant:"elevated"},{default:i(()=>t[16]||(t[16]=[v(" saqlash ")])),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1},8,["modelValue"])])}}},ol={class:"text-center"},ul={__name:"UpdateLocalCode",props:{updatingItem:Object,regionList:Array,updateDialog:{type:Boolean,default:!1}},emits:["updated","update:updateDialog"],setup(c,{emit:h}){const V=c,b=h;function u(){b("update:updateDialog",!1)}const p=j(),o=f(),q=f(null);async function y(){const s=await P(V.updatingItem.id);s&&(o.value=s)}async function t(){const{valid:s}=await q.value.validate();if(!s)return;const l=await Q(V.updatingItem.id,o.value);(l==null?void 0:l.status)===200?(p.success("Muvofaqqiyatli yaratildi."),b("update:updateDialog",!1),b("updated"),q.value.reset()):p.error("Xatolik yuz berdi")}return R(()=>V.updateDialog,s=>{o.value={...V.updatingItem},y()}),(s,l)=>{const C=B("mask");return L(),F("div",ol,[e(M,{modelValue:V.updateDialog,"onUpdate:modelValue":l[10]||(l[10]=a=>V.updateDialog=a),"max-width":"800"},{default:i(()=>[e(x,{class:"pa-4"},{default:i(()=>[e(w,null,{default:i(()=>l[11]||(l[11]=[v(" O'zgartirish ")])),_:1}),e(N,{class:"mb-4"}),e(T,{ref_key:"form",ref:q,onSubmit:$(t,["prevent"])},{default:i(()=>[e(z,null,{default:i(()=>[e(d,{cols:"12",md:"6"},{default:i(()=>[e(r,{modelValue:o.value.code,"onUpdate:modelValue":l[0]||(l[0]=a=>o.value.code=a),rules:[a=>!!a||"to'ldirish majburiy!",a=>a&&a.length>=3||"kamida 3 raqamdan iborat bo'lishi zarur"],label:"Lokal kod",required:""},null,8,["modelValue","rules"])]),_:1}),e(d,{cols:"12",md:"6"},{default:i(()=>[e(r,{modelValue:o.value.name,"onUpdate:modelValue":l[1]||(l[1]=a=>o.value.name=a),rules:[a=>!!a||"to'ldirish majburiy!",a=>a&&a.length>=3||"kamida 3 harfdan iborat bo'lishi zarur"],label:"Filial nomi",required:""},null,8,["modelValue","rules"])]),_:1}),e(d,{cols:"12",md:"6"},{default:i(()=>[e(r,{modelValue:o.value.address,"onUpdate:modelValue":l[2]||(l[2]=a=>o.value.address=a),rules:[a=>!!a||"to'ldirish majburiy!",a=>a&&a.length>=3||" kamida 3 harfdan iborat bo'lishi zarur"],label:"Filial manzili",required:""},null,8,["modelValue","rules"])]),_:1}),e(d,{cols:"12",md:"6"},{default:i(()=>[e(I,{modelValue:o.value.region_id,"onUpdate:modelValue":l[3]||(l[3]=a=>o.value.region_id=a),items:c.regionList,rules:[a=>!!a||"to'ldirish majburiy!"],clearable:"","item-title":"name_uz","item-value":"id",label:"Viloyat",required:""},null,8,["modelValue","items","rules"])]),_:1}),e(d,{cols:"12",md:"6"},{default:i(()=>[e(r,{modelValue:o.value.location_long,"onUpdate:modelValue":l[4]||(l[4]=a=>o.value.location_long=a),rules:[a=>!!a||"to'ldirish majburiy!",a=>a&&a.length>=3||""],hint:"Masalan: 41.2995 (navigator orqali olish mumkin)",label:"Joylashuv uzunligi","persistent-hint":"",required:""},null,8,["modelValue","rules"])]),_:1}),e(d,{cols:"12",md:"6"},{default:i(()=>[e(r,{modelValue:o.value.location_latt,"onUpdate:modelValue":l[5]||(l[5]=a=>o.value.location_latt=a),rules:[a=>!!a||"to'ldirish majburiy!",a=>a&&a.length>=3||""],hint:"Masalan: 69.2401 (navigator orqali olish mumkin)",label:"Joylashuv kengligi","persistent-hint":"",required:""},null,8,["modelValue","rules"])]),_:1}),e(d,{cols:"12",md:"6"},{default:i(()=>[e(r,{modelValue:o.value.index,"onUpdate:modelValue":l[6]||(l[6]=a=>o.value.index=a),rules:[a=>!!a||"to'ldirish majburiy!",a=>a&&a.length>=3||" kamida 3 harfdan iborat bo'lishi zarur"],label:"Filial indeksi",required:""},null,8,["modelValue","rules"])]),_:1}),e(d,{cols:"12",md:"6"},{default:i(()=>[U(e(r,{modelValue:o.value.phone_number,"onUpdate:modelValue":l[7]||(l[7]=a=>o.value.phone_number=a),rules:[a=>!!a||"to'ldirish majburiy!",a=>a&&a.length>=14||"Telefon raqamni to'g'ri kiriting"],label:"Filial telefon raqami",required:""},null,8,["modelValue","rules"]),[[C,"(##) ###-##-##"]])]),_:1}),e(d,{cols:"12",md:"6"},{default:i(()=>[U(e(r,{modelValue:o.value.inn,"onUpdate:modelValue":l[8]||(l[8]=a=>o.value.inn=a),rules:[a=>!!a||"to'ldirish majburiy!",a=>a&&a.length>=9||"INN raqamini to'g'ri kiriting"],label:"Filial INN raqami",required:""},null,8,["modelValue","rules"]),[[C,"#########"]])]),_:1}),e(d,{cols:"12",md:"6"},{default:i(()=>[e(r,{modelValue:o.value.manager,"onUpdate:modelValue":l[9]||(l[9]=a=>o.value.manager=a),label:"Filial boshqaruvchisi",required:""},null,8,["modelValue"])]),_:1})]),_:1}),e(S,{class:"d-flex w-full justify-end mt-4"},{default:i(()=>[e(k,{color:"error",variant:"elevated",onClick:u},{default:i(()=>l[12]||(l[12]=[v(" bekor qilish ")])),_:1}),e(k,{color:"success",type:"submit",variant:"elevated"},{default:i(()=>l[13]||(l[13]=[v(" saqlash ")])),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1},8,["modelValue"])])}}},dl={style:{"min-width":"120px"}},Ul={__name:"index",setup(c){const h=j(),V=al(),b=f(!1),u=f([]),p=f([]),o=f(null);async function q(){const g=await ll();g.length&&(u.value=g)}async function y(){b.value=!0;const g=await W(o.value);b.value=!1,g.length&&(p.value=g)}const t=f(!1),s=f(null),l=f(!1);function C(g){s.value=g,t.value=!0}async function a(){l.value=!0;const g=await Z(s.value.id);l.value=!1,g.status===200&&h.success("Muvofaqqiyatli o'chirildi"),t.value=!1,await y()}const D=f(!1);function A(g){s.value=null,s.value=g,D.value=!0}return O(()=>{q(),y()}),(g,n)=>(L(),F(X,null,[e(ul,{"update-dialog":D.value,"onUpdate:updateDialog":n[0]||(n[0]=m=>D.value=m),"region-list":u.value,"updating-item":s.value,onUpdated:y},null,8,["update-dialog","region-list","updating-item"]),e(x,{flat:""},{default:i(()=>[e(z,{class:"ma-2"},{default:i(()=>[e(d,{cols:"12",md:"6"},{default:i(()=>[e(w,{class:"d-flex align-center pe-2"},{default:i(()=>n[6]||(n[6]=[v(" Filiallar ")])),_:1})]),_:1}),e(d,{class:"d-flex",cols:"12",md:"6"},{default:i(()=>[e(I,{modelValue:o.value,"onUpdate:modelValue":[n[1]||(n[1]=m=>o.value=m),y],items:u.value,clearable:"",density:"compact","item-title":"name_uz","item-value":"id",label:"Viloyatlar"},null,8,["modelValue","items"]),e(tl,{"region-list":u.value,onCreated:y},null,8,["region-list"])]),_:1})]),_:1}),e(N),e(el,{headers:E(V).headers,items:p.value,loading:b.value,"fixed-header":"",height:"71vh","loading-text":"ma'lumotlar yuklanmoqda","no-data-text":"ma'lumot topilmadi"},{"item.id":i(({item:m,index:_})=>[v(H(_+1),1)]),"item.actions":i(({item:m})=>[K("div",dl,[e(k,{color:"warning",density:"default",icon:"mdi-pencil-circle",size:"x-large",variant:"plain",onClick:_=>A(m)},null,8,["onClick"]),e(k,{color:"error",density:"default",icon:"mdi-delete",size:"x-large",variant:"plain",onClick:_=>C(m)},null,8,["onClick"])])]),_:1},8,["headers","items","loading"]),e(M,{modelValue:t.value,"onUpdate:modelValue":n[5]||(n[5]=m=>t.value=m),"max-width":"800",persistent:""},{default:i(()=>[e(x,{class:"pa-4"},{actions:i(()=>[e(Y),e(k,{color:"success",onClick:n[4]||(n[4]=m=>t.value=!1)},{default:i(()=>n[8]||(n[8]=[v(" Bekor qilish ")])),_:1}),e(k,{loading:l.value,color:"error",onClick:a},{default:i(()=>n[9]||(n[9]=[v(" Tasdiqlash ")])),_:1},8,["loading"])]),default:i(()=>[e(w,{class:"text-center mb-4 font-weight-bold"},{default:i(()=>n[7]||(n[7]=[v(" Ushbu ma'lumotni o'chirishni tasdiqlaysizmi? ")])),_:1}),e(z,{class:"mb-4"},{default:i(()=>[e(d,{cols:"12",md:"6"},{default:i(()=>[e(r,{modelValue:s.value.name,"onUpdate:modelValue":n[2]||(n[2]=m=>s.value.name=m),label:"Filial nomi",readonly:""},null,8,["modelValue"])]),_:1}),e(d,{cols:"12",md:"6"},{default:i(()=>[e(r,{modelValue:s.value.code,"onUpdate:modelValue":n[3]||(n[3]=m=>s.value.code=m),label:"Filial kodi",readonly:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})],64))}};export{Ul as default};
