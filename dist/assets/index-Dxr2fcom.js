import{aD as ce,a8 as K,a9 as W,aa as se,ab as Z,ac as G,b as e,bg as be,ax as Ve,af as ye,ag as pe,ai as he,Y as X,bh as _e,az as ke,aj as xe,aA as we,bi as Te,aq as Ce,X as ne,aR as re,aL as H,bj as $,aJ as qe,aV as De,aE as Q,r as y,o as D,c as ee,e as t,s as h,a3 as w,V as de,a2 as me,aF as _,m as u,w as ge,f as L,x as R,D as Ue,F as ze,Z as O,t as Pe,d as Be}from"./index-BUWpNgCh.js";import{a as M}from"./axios-BAixJXzr.js";import{c as ae,b as le}from"./districtService-DVDSdvc1.js";import{V as F,d as te,b as J}from"./VCard-BAYbD_fM.js";import{V as Me}from"./VImg-CfyBjxYh.js";import{V as ie}from"./VDivider-E9DHGbd1.js";import{V as fe}from"./VForm-DC1LXLNq.js";import{V as A,a as b}from"./VRow-DTE0XFEN.js";import{V as z}from"./VAutocomplete-eBmMI_HG.js";import{V as oe}from"./VDialog-TVbLP3yi.js";import{g as Ne}from"./regionService-DfvC8Esu.js";import{V as Se,a as Ie}from"./VDataTableVirtual-fe1D3rEJ.js";import{V as $e}from"./filter-DKa52c3h.js";import"./VAvatar-B6xxjCX8.js";import"./VList-CeZzF82H.js";import"./VChip-BggzV1kk.js";const Le=ce("neighborhood",{state:()=>({headers:[{title:"â„–",align:"start",key:"id",sortable:!1},{title:"Mahalla nomi",align:"start",key:"name"},{title:"Viloyat",align:"start",key:"region.name_uz"},{title:"Tuman",align:"start",key:"district.name_uz"},{title:"MFY kodi",align:"start",key:"mfy_code"},{title:"IABSdagi kodi",align:"start",key:"iabs_mfy_code"},{title:"Sozlamalar",align:"end",key:"actions",sortable:!1}],pageParams:{page:1,size:20,name:null,region_id:null,neighborhood_id:null,district_id:null}}),actions:{}});async function Re(a){try{const{data:d}=await M.get("/neighborhood/v1/get-paginated",{params:{page:a.page,size:a.size,region_id:a.region_id,neighborhood_id:a.neighborhood_id,district_id:a.district_id,name:a.name,lang:"uz"}});return d}catch(d){return d}}async function Fe(a){try{const{data:d}=await M.get("/neighborhood/v1/get-one",{params:{neighborhood_id:a}});return d}catch(d){return d}}async function Ae(a){try{return await M.delete("/neighborhood/v1/delete",{params:{neighborhood_id:a}})}catch(d){return d}}async function je(a){try{return await M.post("/neighborhood/v1/create",a)}catch(d){return d}}async function Ee(a,d){try{return await M.put("/neighborhood/v1/update",d,{params:{neighborhood_id:a}})}catch(l){return l}}function Ye(a){return a==null}function He(a){return Array.isArray(a)&&a.length===0}function C(a){return Ye(a)||He(a)?"To'ldirish majburiy":!!String(a).trim().length||"To'ldirish majburiy"}const j=a=>a?!0:"To'ldirish majburiy!",q=a=>d=>d&&d.trim().length>=a||`Kamida ${a} harfdan iborat bo'lishi zarur`,E=a=>/^\d+$/.test(a)||"Faqat raqam kiritish mumkin",Oe=K({text:String,...W(),...se()},"VToolbarTitle"),ve=Z()({name:"VToolbarTitle",props:Oe(),setup(a,d){let{slots:l}=d;return G(()=>{const V=!!(l.default||l.text||a.text);return e(a.tag,{class:["v-toolbar-title",a.class],style:a.style},{default:()=>{var g;return[V&&e("div",{class:"v-toolbar-title__placeholder"},[l.text?l.text():a.text,(g=l.default)==null?void 0:g.call(l)])]}})}),{}}}),Xe=[null,"prominent","default","comfortable","compact"],Je=K({absolute:Boolean,collapse:Boolean,color:String,density:{type:String,default:"default",validator:a=>Xe.includes(a)},extended:Boolean,extensionHeight:{type:[Number,String],default:48},flat:Boolean,floating:Boolean,height:{type:[Number,String],default:64},image:String,title:String,...be(),...W(),...Ve(),...ye(),...se({tag:"header"}),...pe()},"VToolbar"),Ke=Z()({name:"VToolbar",props:Je(),setup(a,d){var s;let{slots:l}=d;const{backgroundColorClasses:V,backgroundColorStyles:g}=he(X(a,"color")),{borderClasses:x}=_e(a),{elevationClasses:m}=ke(a),{roundedClasses:p}=xe(a),{themeClasses:k}=we(a),{rtlClasses:T}=Te(),c=Ce(!!(a.extended||(s=l.extension)!=null&&s.call(l))),o=ne(()=>parseInt(Number(a.height)+(a.density==="prominent"?Number(a.height):0)-(a.density==="comfortable"?8:0)-(a.density==="compact"?16:0),10)),i=ne(()=>c.value?parseInt(Number(a.extensionHeight)+(a.density==="prominent"?Number(a.extensionHeight):0)-(a.density==="comfortable"?4:0)-(a.density==="compact"?8:0),10):0);return re({VBtn:{variant:"text"}}),G(()=>{var S;const r=!!(a.title||l.title),P=!!(l.image||a.image),N=(S=l.extension)==null?void 0:S.call(l);return c.value=!!(a.extended||N),e(a.tag,{class:["v-toolbar",{"v-toolbar--absolute":a.absolute,"v-toolbar--collapse":a.collapse,"v-toolbar--flat":a.flat,"v-toolbar--floating":a.floating,[`v-toolbar--density-${a.density}`]:!0},V.value,x.value,m.value,p.value,k.value,T.value,a.class],style:[g.value,a.style]},{default:()=>[P&&e("div",{key:"image",class:"v-toolbar__image"},[l.image?e(H,{key:"image-defaults",disabled:!a.image,defaults:{VImg:{cover:!0,src:a.image}}},l.image):e(Me,{key:"image-img",cover:!0,src:a.image},null)]),e(H,{defaults:{VTabs:{height:$(o.value)}}},{default:()=>{var U,I,B;return[e("div",{class:"v-toolbar__content",style:{height:$(o.value)}},[l.prepend&&e("div",{class:"v-toolbar__prepend"},[(U=l.prepend)==null?void 0:U.call(l)]),r&&e(ve,{key:"title",text:a.title},{text:l.title}),(I=l.default)==null?void 0:I.call(l),l.append&&e("div",{class:"v-toolbar__append"},[(B=l.append)==null?void 0:B.call(l)])])]}}),e(H,{defaults:{VTabs:{height:$(i.value)}}},{default:()=>[e(qe,null,{default:()=>[c.value&&e("div",{class:"v-toolbar__extension",style:{height:$(i.value)}},[N])]})]})]})}),{contentHeight:o,extensionHeight:i}}}),We=K({...W(),...De({variant:"text"})},"VToolbarItems"),Ze=Z()({name:"VToolbarItems",props:We(),setup(a,d){let{slots:l}=d;return re({VBtn:{color:X(a,"color"),height:"inherit",variant:X(a,"variant")}}),G(()=>{var V;return e("div",{class:["v-toolbar-items",a.class],style:a.style},[(V=l.default)==null?void 0:V.call(l)])}),{}}}),Ge={class:"text-center"},Qe={__name:"CreateNeighborhood",props:{regionsList:Array},emits:["created"],setup(a,{emit:d}){const l=d,V=Q(),g=y({name_uz:null,name_ru:null,mfy_code:null,iabs_mfy_code:null,region_id:null,district_id:null}),x=y([]);async function m(){let c=null;g.value.district_id=null,g.value.region_id?c=await ae(g.value.region_id):c=await le(),c!=null&&c.length&&(x.value=c)}const p=y(!1),k=y(null);async function T(){const{valid:c}=await k.value.validate();if(!c)return;(await je(g.value)).status===200?(V.success("Muvofaqqiyatli yaratildi."),l("created"),k.value.reset(),p.value=!1):V.error("Xatolik yuz berdi!")}return(c,o)=>(D(),ee("div",Ge,[e(w,{class:"ml-3",onClick:o[0]||(o[0]=i=>p.value=!0)},{default:t(()=>o[11]||(o[11]=[h(" qo'shish ")])),_:1}),e(oe,{modelValue:p.value,"onUpdate:modelValue":o[10]||(o[10]=i=>p.value=i),width:"90%"},{default:t(()=>[e(F,{class:"pa-4"},{default:t(()=>[e(Ke,null,{default:t(()=>[e(ve,null,{default:t(()=>o[12]||(o[12]=[h("Mahalla yaratish")])),_:1}),e(de),e(Ze,null,{default:t(()=>[e(w,{color:"error",density:"default",icon:"mdi-close",size:"x-large",variant:"plain",onClick:o[1]||(o[1]=i=>p.value=!1)})]),_:1})]),_:1}),e(ie,{class:"mb-4"}),e(fe,{ref_key:"form",ref:k,onSubmit:me(T,["prevent"])},{default:t(()=>[e(A,null,{default:t(()=>[e(b,{cols:"12",md:"6"},{default:t(()=>[e(_,{modelValue:g.value.name_uz,"onUpdate:modelValue":o[2]||(o[2]=i=>g.value.name_uz=i),rules:[u(C),u(q)(3)],label:"Mahalla nomi (uz)",required:""},null,8,["modelValue","rules"])]),_:1}),e(b,{cols:"12",md:"6"},{default:t(()=>[e(_,{modelValue:g.value.name_ru,"onUpdate:modelValue":o[3]||(o[3]=i=>g.value.name_ru=i),rules:[u(C),u(q)(3)],label:"Mahalla nomi (ru)",required:""},null,8,["modelValue","rules"])]),_:1}),e(b,{cols:"12",md:"6"},{default:t(()=>[e(_,{modelValue:g.value.mfy_code,"onUpdate:modelValue":o[4]||(o[4]=i=>g.value.mfy_code=i),rules:[u(C),u(q)(3),u(E)],label:"MFY kodi",required:""},null,8,["modelValue","rules"])]),_:1}),e(b,{cols:"12",md:"6"},{default:t(()=>[e(_,{modelValue:g.value.iabs_mfy_code,"onUpdate:modelValue":o[5]||(o[5]=i=>g.value.iabs_mfy_code=i),rules:[u(C),u(q)(3),u(E)],label:"IABS MFY kodi",required:""},null,8,["modelValue","rules"])]),_:1}),e(b,{cols:"12",md:"6"},{default:t(()=>[e(z,{modelValue:g.value.region_id,"onUpdate:modelValue":[o[6]||(o[6]=i=>g.value.region_id=i),o[7]||(o[7]=i=>m())],items:a.regionsList,rules:[u(j)],"item-title":"name","item-value":"id",label:"Viloyat",required:""},null,8,["modelValue","items","rules"])]),_:1}),e(b,{cols:"12",md:"6"},{default:t(()=>[e(z,{modelValue:g.value.district_id,"onUpdate:modelValue":o[8]||(o[8]=i=>g.value.district_id=i),items:x.value,rules:[u(j)],"item-title":"name","item-value":"id",label:"Tuman",required:""},null,8,["modelValue","items","rules"])]),_:1})]),_:1}),e(te,{class:"d-flex w-full justify-end mt-4"},{default:t(()=>[e(w,{color:"error",variant:"elevated",onClick:o[9]||(o[9]=i=>p.value=!1)},{default:t(()=>o[13]||(o[13]=[h(" bekor qilish ")])),_:1}),e(w,{color:"success",type:"submit",variant:"elevated"},{default:t(()=>o[14]||(o[14]=[h(" saqlash ")])),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1},8,["modelValue"])]))}},ea={class:"text-center"},aa={__name:"UpdateNeighborhood",props:{regionsList:Array,updatingItem:Object,updateDialog:{type:Boolean,default:!1}},emits:["updated","update:updateDialog"],setup(a,{emit:d}){const l=a,V=d;function g(){V("update:updateDialog",!1)}const x=Q(),m=y(null),p=y(null);async function k(){const i=await Fe(l.updatingItem.id);i&&(m.value=i,await o())}async function T(){const{valid:i}=await p.value.validate();if(!i)return;const s=await Ee(l.updatingItem.id,m.value);(s==null?void 0:s.status)===200?(x.success("Muvofaqqiyatli yangilandi."),V("update:updateDialog",!1),V("updated"),p.value.reset()):x.error("Xatolik yuz berdi")}const c=y([]);async function o(){let i=null;l.updatingItem.region.id!==m.value.region_id&&(m.value.district_id=null),m.value.region_id?i=await ae(m.value.region_id):i=await le(),i!=null&&i.length&&(c.value=i)}return ge(()=>l.updateDialog,i=>{k()}),(i,s)=>(D(),ee("div",ea,[e(oe,{modelValue:l.updateDialog,"onUpdate:modelValue":s[7]||(s[7]=r=>l.updateDialog=r),"max-width":"800"},{default:t(()=>[e(F,{class:"pa-4"},{default:t(()=>[e(J,null,{default:t(()=>s[8]||(s[8]=[h(" Mahalla ma'lumotlarini tahrirlash ")])),_:1}),e(ie,{class:"mb-4"}),m.value?(D(),L(fe,{key:0,ref_key:"form",ref:p,onSubmit:me(T,["prevent"])},{default:t(()=>[e(A,null,{default:t(()=>[e(b,{cols:"12",md:"6"},{default:t(()=>[e(_,{modelValue:m.value.name_uz,"onUpdate:modelValue":s[0]||(s[0]=r=>m.value.name_uz=r),rules:[u(C),u(q)(3)],label:"Mahalla nomi (uz)",required:""},null,8,["modelValue","rules"])]),_:1}),e(b,{cols:"12",md:"6"},{default:t(()=>[e(_,{modelValue:m.value.name_ru,"onUpdate:modelValue":s[1]||(s[1]=r=>m.value.name_ru=r),rules:[u(C),u(q)(3)],label:"Mahalla nomi (ru)",required:""},null,8,["modelValue","rules"])]),_:1}),e(b,{cols:"12",md:"6"},{default:t(()=>[e(_,{modelValue:m.value.mfy_code,"onUpdate:modelValue":s[2]||(s[2]=r=>m.value.mfy_code=r),rules:[u(C),u(q)(3),u(E)],label:"MFY kodi",required:""},null,8,["modelValue","rules"])]),_:1}),e(b,{cols:"12",md:"6"},{default:t(()=>[e(_,{modelValue:m.value.iabs_mfy_code,"onUpdate:modelValue":s[3]||(s[3]=r=>m.value.iabs_mfy_code=r),rules:[u(C),u(q)(3),u(E)],label:"IABS MFY kodi",required:""},null,8,["modelValue","rules"])]),_:1}),e(b,{cols:"12",md:"6"},{default:t(()=>[e(z,{modelValue:m.value.region_id,"onUpdate:modelValue":[s[4]||(s[4]=r=>m.value.region_id=r),s[5]||(s[5]=r=>o())],items:a.regionsList,rules:[u(j)],"item-title":"name","item-value":"id",label:"Viloyat",required:""},null,8,["modelValue","items","rules"])]),_:1}),e(b,{cols:"12",md:"6"},{default:t(()=>[e(z,{modelValue:m.value.district_id,"onUpdate:modelValue":s[6]||(s[6]=r=>m.value.district_id=r),items:c.value,rules:[u(j)],"item-title":"name","item-value":"id",label:"Tuman",required:""},null,8,["modelValue","items","rules"])]),_:1})]),_:1}),e(te,{class:"d-flex w-full justify-end mt-4"},{default:t(()=>[e(w,{color:"error",variant:"elevated",onClick:g},{default:t(()=>s[9]||(s[9]=[h(" bekor qilish ")])),_:1}),e(w,{color:"success",type:"submit",variant:"elevated"},{default:t(()=>s[10]||(s[10]=[h(" saqlash ")])),_:1})]),_:1})]),_:1},512)):R("",!0)]),_:1})]),_:1},8,["modelValue"])]))}},ue={},la={style:{"min-width":"120px"}},ta={__name:"index",setup(a){const d=Q(),l=Le(),V=y(!1),g=y({items:[],total:0}),x=y(0),m=y([]);async function p(){const f=await Ne();f!=null&&f.length&&(m.value=f)}const k=y([]);async function T(){const f=await le();f!=null&&f.length&&(k.value=f)}async function c(){if(l.pageParams.district_id=null,l.pageParams.page=1,await i(),l.pageParams.region_id){const f=await ae(l.pageParams.region_id);f!=null&&f.length&&(k.value=f)}else await T()}function o(){l.pageParams.page=1,i()}async function i(){V.value=!0;const f=await Re(l.pageParams);V.value=!1,f!=null&&f.items&&(g.value=f,x.value=Math.ceil(g.value.total/l.pageParams.size))}const s=y(!1),r=y(null),P=y(!1);function N(f){r.value=f,s.value=!0}async function S(){P.value=!0;const f=await Ae(r.value.id);P.value=!1,f.status===200&&d.success("Muvofaqqiyatli o'chirildi"),s.value=!1,await i()}const U=y(!1);function I(f){r.value=null,r.value=f,U.value=!0}let B=null;return ge(()=>l.pageParams.name,(f,n)=>{clearTimeout(B),B=setTimeout(()=>{l.pageParams.page=1,i()},600)}),Ue(()=>{i(),p(),T()}),(f,n)=>(D(),ee(ze,null,[e(aa,{"update-dialog":U.value,"onUpdate:updateDialog":n[0]||(n[0]=v=>U.value=v),"regions-list":m.value,"updating-item":r.value,onUpdated:i},null,8,["update-dialog","regions-list","updating-item"]),e(F,{flat:""},{default:t(()=>[e(A,{class:"ma-2"},{default:t(()=>[e(b,{cols:"12",md:"4"},{default:t(()=>[e(J,{class:"d-flex align-center pe-2"},{default:t(()=>n[14]||(n[14]=[h(" Mahallalar ro'yxati ")])),_:1})]),_:1}),e(b,{class:"d-flex justify-end",cols:"12",md:"8"},{default:t(()=>[e(z,{modelValue:u(l).pageParams.region_id,"onUpdate:modelValue":[n[1]||(n[1]=v=>u(l).pageParams.region_id=v),n[2]||(n[2]=v=>c())],items:m.value,class:"mr-4",clearable:"",density:"compact","item-title":"name","item-value":"id",label:"Viloyat","prepend-inner-icon":"mdi-magnify"},null,8,["modelValue","items"]),e(z,{modelValue:u(l).pageParams.district_id,"onUpdate:modelValue":[n[3]||(n[3]=v=>u(l).pageParams.district_id=v),n[4]||(n[4]=v=>o())],items:k.value,clearable:"",density:"compact","item-title":"name","item-value":"id",label:"Tuman","prepend-inner-icon":"mdi-magnify"},null,8,["modelValue","items"]),u(O)("/neighborhood/v1/create")?(D(),L(Qe,{key:0,"regions-list":m.value,onCreated:n[5]||(n[5]=v=>i())},null,8,["regions-list"])):R("",!0)]),_:1})]),_:1}),e(ie),e(Se,{headers:u(l).headers,items:g.value.items,loading:V.value,"fixed-header":"",height:"68vh","loading-text":"ma'lumotlar yuklanmoqda","no-data-text":"ma'lumot topilmadi"},{"item.id":t(({item:v,index:Y})=>[h(Pe(Y+1),1)]),"item.actions":t(({item:v})=>[Be("div",la,[u(O)("/neighborhood/v1/update")?(D(),L(w,{key:0,color:"warning",density:"default",icon:"mdi-pencil-circle",size:"x-large",variant:"plain",onClick:Y=>I(v)},null,8,["onClick"])):R("",!0),u(O)("/neighborhood/v1/delete")?(D(),L(w,{key:1,color:"error",density:"default",icon:"mdi-delete",size:"x-large",variant:"plain",onClick:Y=>N(v)},null,8,["onClick"])):R("",!0)])]),_:1},8,["headers","items","loading"]),e(te,{class:"w-full d-flex justify-space-between mt-2"},{default:t(()=>[e($e,{modelValue:u(l).pageParams.size,"onUpdate:modelValue":[n[6]||(n[6]=v=>u(l).pageParams.size=v),o],items:[10,20,50],label:"Har bir sahifa","max-width":"150"},null,8,["modelValue"]),e(Ie,{modelValue:u(l).pageParams.page,"onUpdate:modelValue":[n[7]||(n[7]=v=>u(l).pageParams.page=v),i],length:x.value,"total-visible":4,rounded:"circle"},null,8,["modelValue","length"])]),_:1}),e(oe,{modelValue:s.value,"onUpdate:modelValue":n[13]||(n[13]=v=>s.value=v),"max-width":"800",persistent:""},{default:t(()=>[e(F,{class:"pa-4"},{actions:t(()=>[e(de),e(w,{color:"success",onClick:n[12]||(n[12]=v=>s.value=!1)},{default:t(()=>n[16]||(n[16]=[h(" Bekor qilish ")])),_:1}),e(w,{loading:P.value,color:"error",onClick:S},{default:t(()=>n[17]||(n[17]=[h(" Tasdiqlash ")])),_:1},8,["loading"])]),default:t(()=>[e(J,{class:"text-center mb-4 font-weight-bold"},{default:t(()=>n[15]||(n[15]=[h(" Ushbu ma'lumotni o'chirishni tasdiqlaysizmi? ")])),_:1}),e(A,{class:"mb-4"},{default:t(()=>[e(b,{cols:"12",md:"6"},{default:t(()=>[e(_,{modelValue:r.value.name,"onUpdate:modelValue":n[8]||(n[8]=v=>r.value.name=v),label:"Mahalla nomi (uz)",readonly:""},null,8,["modelValue"])]),_:1}),e(b,{cols:"12",md:"6"},{default:t(()=>[e(_,{modelValue:r.value.mfy_code,"onUpdate:modelValue":n[9]||(n[9]=v=>r.value.mfy_code=v),label:"MFY kodi",readonly:""},null,8,["modelValue"])]),_:1}),e(b,{cols:"12",md:"6"},{default:t(()=>[e(_,{modelValue:r.value.region.name_uz,"onUpdate:modelValue":n[10]||(n[10]=v=>r.value.region.name_uz=v),label:"Viloyat",readonly:""},null,8,["modelValue"])]),_:1}),e(b,{cols:"12",md:"6"},{default:t(()=>[e(_,{modelValue:r.value.district.name_uz,"onUpdate:modelValue":n[11]||(n[11]=v=>r.value.district.name_uz=v),label:"Tuman",readonly:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})],64))}};typeof ue=="function"&&ue(ta);export{ta as default};
